# TrustChain Agent ‚Äî Integration Standard v3.1

**–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ —Å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –≤ –≤–∞—à—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—É**

---

## –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|----------|
| üîå Plug-and-play | –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –≤—Å–µ tools –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ MCP |
| üîê TrustChain | –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∞–≥–µ–Ω—Ç–∞ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è Ed25519 ‚Äî –ø–æ–ª–Ω—ã–π audit trail |
| üëÅÔ∏è –í–∏–∑—É–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø | –ê–≥–µ–Ω—Ç –≤–∏–¥–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ Playwright (snapshot, screenshot, click) |
| üí¨ –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —á–∞—Ç | –ì–æ—Ç–æ–≤—ã–π sidebar-–≤–∏–¥–∂–µ—Ç —á–µ—Ä–µ–∑ `<iframe>` |
| üîÑ –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –æ–±–º–µ–Ω | postMessage API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è UI —Ö–æ—Å—Ç-—Å—Ç—Ä–∞–Ω–∏—Ü—ã |

---

## Quick Start ‚Äî 3 —à–∞–≥–∞

### –®–∞–≥ 1. –°–æ–∑–¥–∞–π—Ç–µ MCP Server

MCP Server ‚Äî HTTP-—Å–µ—Ä–≤–∏—Å –≤–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –∞–≥–µ–Ω—Ç–∞.

> [!IMPORTANT]
> **–í—Å–µ tools –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–æ–ª–∂–Ω—ã –∂–∏—Ç—å –≤ –≤–∞—à–µ–º MCP Server.** –ê–≥–µ–Ω—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞ ‚Äî –æ–Ω –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –≤–∞—à–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ MCP –ø—Ä–æ—Ç–æ–∫–æ–ª.

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä (Python):

```python
from fastapi import FastAPI
import uvicorn, httpx

BACKEND = "http://localhost:8000"  # URL –≤–∞—à–µ–≥–æ API
app = FastAPI()

@app.post("/tools/list")
async def list_tools():
    return {"tools": [
        {
            "name": "list_items",
            "description": "–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏: id, name, status, created_at. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "filter": {"type": "string", "description": "–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏"},
                    "status": {"type": "string", "enum": ["active", "archived"], "description": "–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É"},
                    "limit": {"type": "integer", "default": 50, "description": "–ú–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)"},
                    "offset": {"type": "integer", "default": 0, "description": "–°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏"}
                }
            }
        }
    ]}

@app.post("/tools/call")
async def call_tool(request: dict):
    name = request["name"]
    args = request.get("arguments", {})
    try:
        async with httpx.AsyncClient() as client:
            if name == "list_items":
                r = await client.get(f"{BACKEND}/api/items", params=args)
                return {"result": {"content": [{"type": "text", "text": r.text}]}}
            else:
                return {"error": f"Unknown tool: {name}"}
    except Exception as e:
        return {"result": {"content": [{"type": "text", "text": f"–û—à–∏–±–∫–∞: {str(e)}"}]}}

@app.get("/health")
def health():
    return {"status": "ok"}

if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=7323)
```

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä (Node.js / Express):

```javascript
const express = require('express');
const app = express();
app.use(express.json());

const tools = [
  {
    name: 'list_items',
    description: '–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏: id, name, status, created_at.',
    inputSchema: {
      type: 'object',
      properties: {
        filter: { type: 'string', description: '–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏' },
        limit:  { type: 'integer', default: 50, description: '–ú–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π' },
        offset: { type: 'integer', default: 0, description: '–°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏' }
      }
    }
  }
];

app.post('/tools/list', (req, res) => res.json({ tools }));
app.post('/tools/call', async (req, res) => {
  const { name, arguments: args } = req.body;
  try {
    // –í—ã–∑—ã–≤–∞–π—Ç–µ –≤–∞—à backend API –∑–¥–µ—Å—å
    res.json({ result: { content: [{ type: 'text', text: JSON.stringify({ items: [], total: 0 }) }] } });
  } catch (e) {
    res.json({ result: { content: [{ type: 'text', text: `–û—à–∏–±–∫–∞: ${e.message}` }] } });
  }
});
app.get('/health', (req, res) => res.json({ status: 'ok' }));

app.listen(7323, () => console.log('MCP Server on :7323'));
```

### –®–∞–≥ 2. –í—Å—Ç—Ä–æ–π—Ç–µ –≤–∏–¥–∂–µ—Ç

```html
<iframe
  src="http://<agent-host>:5173/panel?instance=myapp&mcp=http://localhost:7323&context=dashboard&theme=dark"
  class="w-full h-full border-0"
  title="TrustChain Agent"
  allow="clipboard-write"
/>
```

### –®–∞–≥ 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ + MCP Server
npm start

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: TrustChain Agent
cd TrustChain_Agent && npm run dev
```

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ Tools

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã MCP Server

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ú–µ—Ç–æ–¥ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|-------|:---:|----------|
| `/tools/list` | POST | ‚úÖ | –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π |
| `/tools/call` | POST | ‚úÖ | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| `/health` | GET | ‚úÖ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ |
| `/resources/list` | POST | ‚Äî | –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| `/resources/read` | POST | ‚Äî | –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |

### –§–æ—Ä–º–∞—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è Tool

```json
{
  "name": "create_order",
  "description": "–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ –ø–æ—Å—Ç–∞–≤–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∑–∞–∫–∞–∑–∞ —Å id, —Å—Ç–∞—Ç—É—Å–æ–º –∏ –¥–∞—Ç–æ–π —Å–æ–∑–¥–∞–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –æ—Ñ–æ—Ä–º–∏—Ç—å/—Å–æ–∑–¥–∞—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "product_id": { "type": "string", "description": "ID —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞" },
      "quantity": { "type": "integer", "minimum": 1, "description": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü" },
      "priority": { "type": "string", "enum": ["normal", "urgent"], "description": "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–∫–∞–∑–∞" }
    },
    "required": ["product_id", "quantity"]
  }
}
```

### –ö–∞—á–µ—Å—Ç–≤–æ –æ–ø–∏—Å–∞–Ω–∏–π ‚Äî –ö–†–ò–¢–ò–ß–ù–û

–ê–≥–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—è–º**. –ü–ª–æ—Ö–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è = –∞–≥–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥—ë—Ç –Ω—É–∂–Ω—ã–π tool –∏–ª–∏ –≤—ã–±–µ—Ä–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

| ‚ùå –ü–ª–æ—Ö–æ | ‚úÖ –•–æ—Ä–æ—à–æ |
|----------|----------|
| `"–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"` | `"–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Ö–æ–¥—è—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Å—Ç–∞—Ç—É—Å—É –∏ –¥–∞—Ç–µ. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤: id, title, sender, status, due_date."` |
| `"–û–±–Ω–æ–≤–∏—Ç—å"` | `"–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ (active ‚Üí completed / cancelled). –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –∑–∞–¥–∞—á–∏."` |
| `"–ü–æ–∏—Å–∫"` | `"–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –∏ –∑–∞–¥–∞—á–∞–º. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ 20 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π."` |

**–ü—Ä–∞–≤–∏–ª–∞ —Ö–æ—Ä–æ—à–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è:**
1. **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç** ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–Ω–µ ¬´—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏¬ª)
2. **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** ‚Äî –ø—Ä–∏ –∫–∞–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–∑—ã–≤–∞—Ç—å
3. **–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç** ‚Äî —Ñ–æ—Ä–º–∞—Ç –∏ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** ‚Äî –º–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π, –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ `/tools/call`

**–£—Å–ø–µ—Ö:**
```json
{
  "result": {
    "content": [
      { "type": "text", "text": "{\"order_id\": \"ORD-123\", \"status\": \"created\"}" }
    ]
  }
}
```

**–û—à–∏–±–∫–∞** ‚Äî –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ `result.content`, –Ω–µ HTTP 500:
```json
{
  "result": {
    "content": [
      { "type": "text", "text": "–û—à–∏–±–∫–∞: –¢–æ–≤–∞—Ä —Å ID P-999 –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–∞—Ç–∞–ª–æ–≥–µ" }
    ]
  }
}
```

> [!WARNING]
> –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –æ—à–∏–±–∫–∏ –∫–∞–∫ HTTP 500 –∏–ª–∏ `{ "error": "..." }`. –ê–≥–µ–Ω—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ ‚Äî –µ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –æ—à–∏–±–∫–∏ –≤ `content.text`.

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ Tools

–ê–≥–µ–Ω—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å `mcp_{instance}_` –∫ –∫–∞–∂–¥–æ–º—É tool. –ù–∞–ø—Ä–∏–º–µ—Ä: `create_order` ‚Üí `mcp_myapp_create_order`.

**–ö–æ–Ω–≤–µ–Ω—Ü–∏—è –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è:**
```
{–¥–µ–π—Å—Ç–≤–∏–µ}_{—Å—É—â–Ω–æ—Å—Ç—å}           ‚Äî create_order, list_documents
{–¥–µ–π—Å—Ç–≤–∏–µ}_{—Å—É—â–Ω–æ—Å—Ç—å}_{–¥–µ—Ç–∞–ª—å}  ‚Äî get_task_history, update_order_status
```

–ò–º–µ–Ω–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **snake_case**, **–ª–∞—Ç–∏–Ω–∏—Ü–µ–π**, **–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤**.

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ Tools

–ö–∞–∂–¥–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ **–¥–æ–ª–∂–Ω–∞** —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º:

| Tool | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-----------|
| `describe_platform` | –û–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ä–∞–∑–¥–µ–ª—ã, –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≥–µ–Ω—Ç–æ–º –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–æ–Ω—Ç–∞–∫—Ç–µ. |
| `describe_current_page` | –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞/—Å—Ç—Ä–∞–Ω–∏—Ü—ã: —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `context` –∏–∑ URL. |

**–ü—Ä–∏–º–µ—Ä `describe_platform`:**
```json
{
  "name": "describe_platform",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∏ –µ—ë –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π. –í—ã–∑—ã–≤–∞–π –ø–µ—Ä–≤—ã–º, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã.",
  "inputSchema": { "type": "object", "properties": {} }
}
```

–û—Ç–≤–µ—Ç:
```json
{
  "result": {
    "content": [{
      "type": "text",
      "text": "OnaiDocs ‚Äî —Å–∏—Å—Ç–µ–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞. –†–∞–∑–¥–µ–ª—ã: –î–æ–∫—É–º–µ–Ω—Ç—ã (–≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ), –ó–∞–¥–∞—á–∏ (–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ–Ω—Ç—Ä–æ–ª—å), –ö–∞–¥—Ä—ã (–≤–∞–∫–∞–Ω—Å–∏–∏, HR), –°–æ–≤–µ—â–∞–Ω–∏—è (–ø—Ä–æ—Ç–æ–∫–æ–ª—ã, –ø–æ—Ä—É—á–µ–Ω–∏—è), –ü—Ä–æ–µ–∫—Ç (Gantt, –∑–∞–¥–∞—á–∏). –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: CRUD –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, —ç–∫—Å–ø–æ—Ä—Ç."
    }]
  }
}
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ Tools

| –ü–∞—Ç—Ç–µ—Ä–Ω | Tools | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------|----------|
| **CRUD** | `list_{entity}`, `get_{entity}`, `create_{entity}`, `update_{entity}`, `delete_{entity}` | –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ |
| **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** | `calculate_metrics`, `generate_report` | KPI, –æ—Ç—á—ë—Ç—ã –∑–∞ –ø–µ—Ä–∏–æ–¥ |
| **–ü–æ–∏—Å–∫** | `search`, `search_{entity}` | –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ |
| **–≠–∫—Å–ø–æ—Ä—Ç** | `export_to_excel`, `export_to_pdf` | –í—ã–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö |

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è

–î–ª—è —Å–ø–∏—Å–∫–æ–≤—ã—Ö tools –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `limit` + `offset`:

```json
{
  "inputSchema": {
    "properties": {
      "limit":  { "type": "integer", "default": 50, "maximum": 200, "description": "–ú–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π" },
      "offset": { "type": "integer", "default": 0, "description": "–°–º–µ—â–µ–Ω–∏–µ" }
    }
  }
}
```

–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å `total`:
```json
{ "items": [...], "total": 342, "limit": 50, "offset": 0 }
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|----------|-------------|
| –ú–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π –∑–∞ –∑–∞–ø—Ä–æ—Å | 200 |
| –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ | –î–æ 50 –ö–ë —Ç–µ–∫—Å—Ç–∞ (–±–æ–ª—å—à–µ ‚Üí –∞–≥–µ–Ω—Ç –ø–æ—Ç–µ—Ä—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç) |
| –¢–∞–π–º–∞—É—Ç | –î–æ 30 —Å–µ–∫—É–Ω–¥ (–¥–ª–∏–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `{ "status": "processing", "task_id": "..." }`) |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ tools | 5‚Äì30 –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É (–±–æ–ª—å—à–µ ‚Üí –∞–≥–µ–Ω—Ç –ø—É—Ç–∞–µ—Ç—Å—è –≤ –≤—ã–±–æ—Ä–µ) |

---

## TrustChain ‚Äî –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ß—Ç–æ —ç—Ç–æ

TrustChain ‚Äî —ç—Ç–æ –Ω–∞—à–∞ –∫–ª—é—á–µ–≤–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è: –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ AI-–∞–≥–µ–Ω—Ç–∞ **–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è** Ed25519 –∫–ª—é—á–æ–º. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –Ω–µ–æ–ø—Ä–æ–≤–µ—Ä–∂–∏–º—ã–π audit trail ‚Äî –∫—Ç–æ, –∫–æ–≥–¥–∞ –∏ –∫–∞–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–æ–≤–µ—Ä—à–∏–ª —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–∞.

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ë–µ–∑ TrustChain | –° TrustChain |
|----------|---------------|-------------|
| AI —Å–æ–∑–¥–∞–ª –∑–∞–∫–∞–∑ | ¬´–ö—Ç–æ-—Ç–æ —Å–æ–∑–¥–∞–ª –∑–∞–∫–∞–∑¬ª | –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –ª–æ–≥: –∞–≥–µ–Ω—Ç X, –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Y, –≤—Ä–µ–º—è Z |
| AI –∏–∑–º–µ–Ω–∏–ª –¥–∞–Ω–Ω—ã–µ | –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ —ç—Ç–æ –Ω–µ —á–µ–ª–æ–≤–µ–∫ | –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ: Ed25519 –ø–æ–¥–ø–∏—Å—å |
| –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π | –õ–æ–≥–∏ –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å | –ü–æ–¥–ø–∏—Å—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å –±–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ |
| Compliance / SOX | –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π | –ü–æ–ª–Ω—ã–π –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã–π trail |

### –§–æ—Ä–º–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

–ö–∞–∂–¥—ã–π `tools/call` –∑–∞–ø—Ä–æ—Å –æ—Ç –∞–≥–µ–Ω—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç TrustChain –∑–∞–≥–æ–ª–æ–≤–∫–∏:

```json
{
  "name": "update_order",
  "arguments": { "id": "ORD-123", "status": "approved" },
  "trustchain": {
    "signature": "ed25519:a7f3b2c8e91d4506f8b2a1c3d5e7f9...",
    "agent_id": "trustchain-agent-001",
    "session_id": "sess_abc123",
    "timestamp": "2026-02-12T06:00:00Z",
    "nonce": "f2c9ca85-40c0-41a2-b8f1-3e7d6a1c9b4e",
    "user_query": "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –∑–∞–∫–∞–∑ ORD-123",
    "sequence": 5
  }
}
```

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `signature` | Ed25519 –ø–æ–¥–ø–∏—Å—å payload: `name + arguments + timestamp + nonce + sequence` |
| `agent_id` | ID —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∞–≥–µ–Ω—Ç–∞ |
| `session_id` | ID —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `timestamp` | ISO 8601 –≤—Ä–µ–º—è –≤—ã–∑–æ–≤–∞ |
| `nonce` | UUID v4 ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä. –°–≥–æ—Ä–∞–µ—Ç –ø—Ä–∏ `verify()`, –±–ª–æ–∫–∏—Ä—É—è replay-–∞—Ç–∞–∫–∏ |
| `user_query` | –ò—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤—ë–ª –∫ —ç—Ç–æ–º—É –≤—ã–∑–æ–≤—É |
| `sequence` | –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –≤—ã–∑–æ–≤–∞ –≤ —Å–µ—Å—Å–∏–∏ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç replay) |

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ MCP Server

```python
from nacl.signing import VerifyKey
import json

AGENT_PUBLIC_KEY = "base64_encoded_public_key_here"

def verify_trustchain(request: dict) -> bool:
    tc = request.get("trustchain")
    if not tc:
        return False  # –ù–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
    
    # –°–æ–±—Ä–∞—Ç—å payload –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    payload = json.dumps({
        "name": request["name"],
        "arguments": request.get("arguments", {}),
        "timestamp": tc["timestamp"],
        "sequence": tc["sequence"]
    }, sort_keys=True)
    
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å
    verify_key = VerifyKey(base64.b64decode(AGENT_PUBLIC_KEY))
    try:
        verify_key.verify(payload.encode(), base64.b64decode(tc["signature"].removeprefix("ed25519:")))
        return True
    except:
        return False
```

### –£—Ä–æ–≤–Ω–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ TrustChain

| –£—Ä–æ–≤–µ–Ω—å | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç–µ | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|---------|------------|:---------:|
| **0 ‚Äî –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å** | –ù–∏—á–µ–≥–æ ‚Äî –∞–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ | ‚Äî |
| **1 ‚Äî –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** | –°–æ—Ö—Ä–∞–Ω—è—Ç—å `trustchain` –æ–±—ä–µ–∫—Ç –≤ –ª–æ–≥ | üü¢ |
| **2 ‚Äî –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** | –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å—å, –æ—Ç–∫–ª–æ–Ω—è—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ | üü° |
| **3 ‚Äî Audit Trail** | –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É: –∫—Ç–æ, –∫–æ–≥–¥–∞, —á—Ç–æ, –ø–æ–¥–ø–∏—Å—å | üü° |
| **4 ‚Äî Compliance** | –ü–æ–ª–Ω—ã–π SOX/audit —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –∏ —Ä–æ—Ç–∞—Ü–∏–µ–π –∫–ª—é—á–µ–π | üî¥ |

> [!TIP]
> –ù–∞—á–Ω–∏—Ç–µ —Å **–£—Ä–æ–≤–Ω—è 1** ‚Äî –ø—Ä–æ—Å—Ç–æ –ª–æ–≥–∏—Ä—É–π—Ç–µ `trustchain` –≤ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ. –≠—Ç–æ –∑–∞–π–º—ë—Ç 2 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ –∏ –¥–∞—Å—Ç –≤–∞–º audit trail –Ω–∞ –±—É–¥—É—â–µ–µ.

### –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∞–≥–µ–Ω—Ç–∞

–ü—Ä–∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–∏ –∞–≥–µ–Ω—Ç–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–∞—Ä–∞ –∫–ª—é—á–µ–π Ed25519. –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```
/panel?instance=myapp&mcp=http://...&trustchain_pubkey=BASE64_PUBLIC_KEY
```

–ò–ª–∏ —á–µ—Ä–µ–∑ `/health` –æ—Ç–≤–µ—Ç MCP Server –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∫–ª—é—á –∞–≥–µ–Ω—Ç–∞.

---

## –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ Panel Widget

### URL-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```
/panel?instance=myapp&mcp=http://localhost:7323&context=dashboard&theme=dark
```

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|:---:|-----------| 
| `instance` | ‚úÖ | Namespace –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏: `myapp`, `crm`, `erp` | 
| `mcp` | ‚úÖ | URL –≤–∞—à–µ–≥–æ MCP —Å–µ—Ä–≤–µ—Ä–∞ |
| `context` | ‚Äî | –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã: `dashboard`, `orders`, `reports` |
| `hostUrl` | ‚Äî | URL —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è Playwright –Ω–∞–≤–∏–≥–∞—Ü–∏–∏) |
| `system` | ‚Äî | Base64-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π system prompt |
| `theme` | ‚Äî | `dark` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) / `light` |
| `lang` | ‚Äî | `ru` / `en` / `kz` |
| `title` | ‚Äî | –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∞–Ω–µ–ª–∏ |

### System Prompt ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞-–∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–∞

> [!CAUTION]
> **TrustChain Agent –ù–ï –î–û–õ–ñ–ï–ù —Å–æ–¥–µ—Ä–∂–∞—Ç—å project-specific system prompts.**
> –ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç-–∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä –æ–±—è–∑–∞–Ω –ø–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å–≤–æ–π system prompt —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `system` –≤ URL.
> –ê–≥–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è domain-agnostic —è–¥—Ä–æ–º ‚Äî –≤—Å—è –¥–æ–º–µ–Ω–Ω–∞—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑–≤–Ω–µ.

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:**
- –ê–≥–µ–Ω—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω ‚Äî –æ–Ω –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏, CRM, ERP –∏ –¥—Ä.
- Domain-specific prompts –≤ –∫–æ–¥–µ –∞–≥–µ–Ω—Ç–∞ = —É—Ç–µ—á–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –º–µ–∂–¥—É –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- –ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥—Ä—É–≥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, –µ—Å–ª–∏ –≤–∏–¥–∏—Ç –∏—Ö –æ–ø–∏—Å–∞–Ω–∏—è –≤ –æ–±—â–µ–º –ø—Ä–æ–º–ø—Ç–µ

**–ß—Ç–æ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å system prompt –ø—Ä–æ–µ–∫—Ç–∞:**

| –≠–ª–µ–º–µ–Ω—Ç | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –ü—Ä–∏–º–µ—Ä |
|---------|:---:|--------|
| –†–æ–ª—å –∞–≥–µ–Ω—Ç–∞ | ‚úÖ | `–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã OnaiDocs` |
| –î–æ—Å—Ç—É–ø–Ω—ã–µ MCP tools | ‚úÖ | –°–ø–∏—Å–æ–∫ tools —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ |
| –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ | ‚úÖ | `–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∏—Å–ø–æ–ª—å–∑—É–π markdown, —Ç–∞–±–ª–∏—Ü—ã` |
| –î–æ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è | ‚Äî | –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞, —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è, KPI |
| –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ | ‚úÖ | `–ó–ê–ü–†–ï–©–ï–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å search_products ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û MCP tools` |

**–ü–µ—Ä–µ–¥–∞–π—Ç–µ system prompt —á–µ—Ä–µ–∑ Base64 –≤ URL iframe:**

```javascript
const systemPrompt = `–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã MyApp. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º.

## –î–æ—Å—Ç—É–ø–Ω—ã–µ MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- **list_items** ‚Äî —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: filter (–ø–æ–∏—Å–∫), status, limit, offset
- **get_item** ‚Äî –¥–µ—Ç–∞–ª–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ ID
- **create_order** ‚Äî —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑: product_id, quantity, priority

‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û MCP tools –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
–§–æ—Ä–º–∞—Ç: markdown, —Ç–∞–±–ª–∏—Ü—ã. –ó–∞–≤–µ—Ä—à–∞–π —Å–µ–∫—Ü–∏–µ–π **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**.`;

const systemB64 = btoa(unescape(encodeURIComponent(systemPrompt)));
const src = `http://localhost:5173/panel?instance=myapp&mcp=...&system=${systemB64}`;
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** MCP tool `describe_platform` –º–æ–∂–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ.

### –ü—Ä–∏–º–µ—Ä –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è (React)

```tsx
const AgentPanel = ({ currentPath }: { currentPath: string }) => {
  const hostUrl = encodeURIComponent(`http://localhost:3000${currentPath}`);
  const mcpUrl = encodeURIComponent('http://localhost:7323');
  
  return (
    <iframe
      src={`http://localhost:5173/panel?instance=myapp&mcp=${mcpUrl}&context=dashboard&theme=dark&hostUrl=${hostUrl}`}
      className="w-full h-full border-0"
      title="TrustChain Agent"
      allow="clipboard-write"
    />
  );
};
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–≤—ã–∫–æ–≤ (quick action –∫–Ω–æ–ø–∫–∏)

1. **postMessage skills** ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –æ—Ç —Ö–æ—Å—Ç-—Å—Ç—Ä–∞–Ω–∏—Ü—ã (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
2. **MCP tools** ‚Äî –ø–µ—Ä–≤—ã–µ 5 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –æ—Ç MCP —Å–µ—Ä–≤–µ—Ä–∞
3. **context fallback** ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é `?context=`

---

## postMessage API ‚Äî –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

–í—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É —Ö–æ—Å—Ç-—Å—Ç—Ä–∞–Ω–∏—Ü–µ–π –∏ –ø–∞–Ω–µ–ª—å—é –∞–≥–µ–Ω—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `postMessage`. –ü—Ä–æ—Ç–æ–∫–æ–ª –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π.

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (v2)

–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –î–û–õ–ñ–ù–û —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

- `type` ‚Äî —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (`trustchain:*`)
- `version` ‚Äî –≤–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (—Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: `2`)
- `source` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ (`onaidocs-host`, `trustchain-panel`, `trustchain-agent`)
- `timestamp` ‚Äî ISO –≤—Ä–µ–º—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –¥–ª—è –∞—É–¥–∏—Ç–∞)
- `requestId` ‚Äî –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è request/response –ø–∞—Ä (`call_action`, `bridge`, `*_result`)

### Handshake (fail-secure –ø–æ—Ä—è–¥–æ–∫)

1. –ü–∞–Ω–µ–ª—å –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `trustchain:ready`.
2. –•–æ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `origin`, `version`, `source`.
3. –•–æ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `trustchain:config`.
4. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã `skills/workflows/document_mode/register_actions`.

> [!IMPORTANT]
> –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `postMessage(..., '*')` –≤ production. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–Ω—ã–π `targetOrigin`.

### –í–∞—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ‚Üí –ü–∞–Ω–µ–ª—å

| –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | Payload |
|---------------|-----------|---------|
| `trustchain:config` | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ –ø–æ—Å–ª–µ `ready` | `{ targetOrigin, instance, context, decision_context }` |
| `trustchain:skills` | –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π | `{ skills: [{ label, prompt, color }] }` |
| `trustchain:query` | –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞ | `{ text: "–∑–∞–ø—Ä–æ—Å" }` |
| `trustchain:auto_query` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ | `{ text: "–∑–∞–ø—Ä–æ—Å" }` |
| `trustchain:register_actions` | –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å client-side tools | `{ actions: [{ name, description, parameters }] }` |
| `trustchain:clear_actions` | –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ actions | `{}` |
| `trustchain:agent_config` | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∞–≥–µ–Ω—Ç–∞ | `{ specialties, complexityKeywords }` |
| `trustchain:intent_patterns` | –ö–∞—Å—Ç–æ–º–Ω—ã–µ intent patterns | `{ patterns: [...] }` |
| `trustchain:domain_hints` | –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è LLM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ | `{ hints: "—Ç–µ–∫—Å—Ç" }` |

### –ü–∞–Ω–µ–ª—å ‚Üí –í–∞—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞

| –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | Payload |
|---------------|-----------|---------|
| `trustchain:ready` | –ü–∞–Ω–µ–ª—å –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–∏—ë–º—É –∫–æ–Ω—Ñ–∏–≥–∞ | `{ version, source, instance, context, capabilities }` |
| `trustchain:call_action` | –ê–≥–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –∑–∞—Ä–µ–≥. action | `{ requestId, name, arguments }` |
| `trustchain:action` | –ê–≥–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—è–µ—Ç UI | `{ action, payload }` |
| `trustchain:response` | –ê–≥–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–∏–ª –æ—Ç–≤–µ—Ç | `{ text, hasArtifacts }` |
| `trustchain:bridge` | Page observe/read/interact | `{ action, payload }` |
| `trustchain:error` | –û—à–∏–±–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞/–≤–µ—Ä—Å–∏–∏ | `{ code, message }` |

### –í–∞—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ‚Üí –ü–∞–Ω–µ–ª—å (–æ—Ç–≤–µ—Ç—ã)

| –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | Payload |
|---------------|-----------|---------|
| `trustchain:action_result` | –û—Ç–≤–µ—Ç –Ω–∞ `call_action` | `{ requestId, success, data, error }` |
| `trustchain:bridge_result` | –û—Ç–≤–µ—Ç –Ω–∞ `bridge` | `{ requestId, success, data }` |

---

## App Actions ‚Äî Client-Side Tools

> [!IMPORTANT]
> App Actions –ø–æ–∑–≤–æ–ª—è—é—Ç —Ö–æ—Å—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é **—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å client-side –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** –¥–ª—è –∞–≥–µ–Ω—Ç–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –∞–≥–µ–Ω—Ç–∞. –≠—Ç–æ —Å–ª–æ–π –¥–ª—è UI-–æ–ø–µ—Ä–∞—Ü–∏–π: –Ω–∞–≤–∏–≥–∞—Ü–∏—è, –≤—ã–±–æ—Ä —Ñ–∞–π–ª–æ–≤, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫.

–î–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (CRUD, –ø–æ–∏—Å–∫, —ç–∫—Å–ø–æ—Ä—Ç) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **MCP Server**. App Actions ‚Äî –¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ **–±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Ö–æ—Å—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**.

### –®–∞–≥ 1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ actions –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

```javascript
const agentFrame = document.getElementById('agent-frame');

agentFrame.contentWindow.postMessage({
  type: 'trustchain:register_actions',
  actions: [
    {
      name: 'select_document',
      description: '–í—ã–±—Ä–∞—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ ID. –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –æ—Ç–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç.',
      parameters: {
        type: 'object',
        properties: {
          documentId: { type: 'string', description: 'ID –¥–æ–∫—É–º–µ–Ω—Ç–∞' }
        },
        required: ['documentId']
      },
      category: 'navigation'
    },
    {
      name: 'get_visible_records',
      description: '–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π, –≤–∏–¥–∏–º—ã—Ö –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤.',
      parameters: { type: 'object', properties: {} },
      category: 'data'
    },
    {
      name: 'switch_tab',
      description: '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.',
      parameters: {
        type: 'object',
        properties: {
          tabName: { type: 'string', enum: ['documents', 'tasks', 'reports'], description: '–ò–º—è –≤–∫–ª–∞–¥–∫–∏' }
        },
        required: ['tabName']
      },
      category: 'navigation'
    }
  ]
}, '*');
```

### –®–∞–≥ 2. –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤—ã–∑–æ–≤—ã –æ—Ç –∞–≥–µ–Ω—Ç–∞

```javascript
window.addEventListener('message', (e) => {
  if (e.data?.type !== 'trustchain:call_action') return;

  const { requestId, name, arguments: args } = e.data;
  console.log(`Agent called action: ${name}`, args);

  try {
    let result;
    switch (name) {
      case 'select_document':
        result = selectDocument(args.documentId); // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
        break;
      case 'get_visible_records':
        result = getVisibleRecords(); // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
        break;
      case 'switch_tab':
        switchTab(args.tabName); // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
        result = { switched: true };
        break;
      default:
        throw new Error(`Unknown action: ${name}`);
    }

    agentFrame.contentWindow.postMessage({
      type: 'trustchain:action_result',
      requestId,
      success: true,
      data: result
    }, '*');
  } catch (err) {
    agentFrame.contentWindow.postMessage({
      type: 'trustchain:action_result',
      requestId,
      success: false,
      error: err.message
    }, '*');
  }
});
```

### –®–∞–≥ 3. –û–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

```javascript
// –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äî –æ—á–∏—â–∞–π—Ç–µ –∏ –ø–µ—Ä–µ—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ
agentFrame.contentWindow.postMessage({ type: 'trustchain:clear_actions' }, '*');
agentFrame.contentWindow.postMessage({
  type: 'trustchain:register_actions',
  actions: getActionsForPage(currentPage)
}, '*');
```

---

## Agent Config ‚Äî –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–ê–≥–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç **—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä**, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ä—É–µ—Ç —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –∑–Ω–∞–µ—Ç —Ç–æ–ª—å–∫–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–∫–æ–¥, –∞–Ω–∞–ª–∏–∑, –¥–∞–Ω–Ω—ã–µ). –•–æ—Å—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å **—Å–≤–æ–∏ –¥–æ–º–µ–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**:

```javascript
agentFrame.contentWindow.postMessage({
  type: 'trustchain:agent_config',
  specialties: [
    {
      name: 'document-specialist',
      patterns: ['–¥–æ–∫—É–º–µ–Ω—Ç', '–≤—Ö–æ–¥—è—â', '–∏—Å—Ö–æ–¥—è—â', '–ø–∏—Å—å–º–æ', 'document', 'correspondence']
    },
    {
      name: 'task-specialist',
      patterns: ['–∑–∞–¥–∞—á', '–ø–æ—Ä—É—á–µ–Ω', '–¥–µ–¥–ª–∞–π–Ω', '–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª', 'task', 'assignee']
    },
    {
      name: 'hr-specialist',
      patterns: ['–∫–∞–¥—Ä', '—Å–æ—Ç—Ä—É–¥–Ω–∏–∫', '–≤–∞–∫–∞–Ω—Å–∏—è', 'hr', 'employee']
    }
  ],
  complexityKeywords: ['–¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç', 'contract management', 'workflow']
}, '*');
```

–≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ–¥–∑–∞–¥–∞—á–∏ –≤ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö —Ç–∏–ø–∞: *¬´–ü–æ–∫–∞–∂–∏ –≤—Å–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ –≤—Ö–æ–¥—è—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∑–∞ —è–Ω–≤–∞—Ä—å, –∞ —Ç–∞–∫–∂–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ HR¬ª* ‚Üí 3 –ø–æ–¥–∑–∞–¥–∞—á–∏ –ø–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º.

---

## Skills ‚Äî –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

### –ü—Ä–∏–º–µ—Ä: –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —ç–ª–µ–º–µ–Ω—Ç–∞

```javascript
panelFrame.contentWindow.postMessage({
  type: 'trustchain:skills',
  skills: [
    { label: '–ê–Ω–∞–ª–∏–∑', prompt: '–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç', color: '#a78bfa' },
    { label: '–°—Ä–∞–≤–Ω–∏—Ç—å', prompt: '–ù–∞–π–¥–∏ –∞–Ω–∞–ª–æ–≥–∏ –∏ —Å—Ä–∞–≤–Ω–∏', color: '#06b6d4' },
    { label: '–û—Ç—á—ë—Ç', prompt: '–°–æ–∑–¥–∞–π –æ—Ç—á—ë—Ç', color: '#34d399' },
  ]
}, '*');
```

---

## Intent Patterns ‚Äî –ö–∞—Å—Ç–æ–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

–ê–≥–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç **—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π intent classifier** (`TaskIntentService`), –∫–æ—Ç–æ—Ä—ã–π
—Ä–∞–∑–±–∏–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —à–∞–≥–∏ —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.
–ü—Ä–æ–µ–∫—Ç –º–æ–∂–µ—Ç –æ–±–æ–≥–∞—Ç–∏—Ç—å –µ–≥–æ –¥–æ–º–µ–Ω–Ω—ã–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ —á–µ—Ä–µ–∑ `trustchain:intent_patterns`:

```javascript
panelFrame.contentWindow.postMessage({
  type: 'trustchain:intent_patterns',
  patterns: [
    {
      action: 'search',
      patterns: ['–¥–æ–∫—É–º–µ–Ω—Ç.*–∑–∞\\s+(—è–Ω–≤–∞—Ä—å|—Ñ–µ–≤—Ä–∞–ª—å)', '–≤—Ö–æ–¥—è—â.*–ø–∏—Å—å–º'],
      requiredTools: ['mcp_panel_app_list_documents']
    },
    {
      action: 'analyze',
      patterns: ['—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫.*–¥–æ–∫—É–º–µ–Ω—Ç', '—Å–∫–æ–ª—å–∫–æ.*–∑–∞–¥–∞—á'],
      requiredTools: ['mcp_panel_app_get_dashboard_stats']
    }
  ]
}, '*');

panelFrame.contentWindow.postMessage({
  type: 'trustchain:domain_hints',
  hints: '–°–∏—Å—Ç–µ–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞. –†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏, –∑–∞–¥–∞—á–∞–º–∏, —Å–æ–≤–µ—â–∞–Ω–∏—è–º–∏, –¥–æ–≥–æ–≤–æ—Ä–∞–º–∏.'
}, '*');
```

---

## Built-in Universal Tools

–ê–≥–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä **—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤** –∏–∑ –∫–æ—Ä–æ–±–∫–∏. –û–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –í–°–ï–ú –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | Tools | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|-------|----------|
| **Web** | `web_search`, `web_fetch` | –ü–æ–∏—Å–∫ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü |
| **Page** | `page_observe`, `page_read`, `page_interact` | –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π —á–µ—Ä–µ–∑ Playwright |
| **Code** | `bash_tool`, `execute_code`, `execute_bash` | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ Docker sandbox |
| **File** | `view`, `create_file`, `str_replace`, `extract_table_to_excel` | –ü—Ä–æ—Å–º–æ—Ç—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ |
| **Browser** | `browser_navigate`, `browser_screenshot`, `browser_extract` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Playwright-–±—Ä–∞—É–∑–µ—Ä–æ–º |
| **Artifacts** | `create_artifact` | –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö HTML/React –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ |
| **Analysis** | `analyze_code_structure`, `search_code_symbols`, `get_code_dependencies` | –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã |

> [!TIP]
> –ù–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ –≤–∞—à–µ–º MCP Server. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ø—Ä–æ—Å–∏—Ç "–ø–æ–∏—Å–∫–∞—Ç—å –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ" –∏–ª–∏ "–≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥" ‚Äî –∞–≥–µ–Ω—Ç —Å–ø—Ä–∞–≤–∏—Ç—Å—è —Å–∞–º.

---

## 4-Tier Architecture ‚Äî –û—Ç–∫—É–¥–∞ –∞–≥–µ–Ω—Ç –±–µ—Ä—ë—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LLM –≤—ã–±–∏—Ä–∞–µ—Ç tool –∏–∑ –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö 4 —É—Ä–æ–≤–Ω–µ–π     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Tier 1: Built-in        ‚îÇ web, code, data, artifacts  ‚îÇ
‚îÇ  Tier 2: MCP Server      ‚îÇ –≤–∞—à–∏ CRUD, –ø–æ–∏—Å–∫, —ç–∫—Å–ø–æ—Ä—Ç   ‚îÇ
‚îÇ  Tier 3: Page Tools      ‚îÇ page_observe, page_read, ... ‚îÇ
‚îÇ  Tier 4: App Actions     ‚îÇ register_actions postMessage ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Tier 1‚Äì3** —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏. **Tier 4** –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.

---

## –ß–µ–∫-–ª–∏—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### üü¢ –£—Ä–æ–≤–µ–Ω—å 1 ‚Äî –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1‚Äì2 —á–∞—Å–∞)

–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞.

- [ ] MCP Server –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `GET /health`
- [ ] `POST /tools/list` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ tools —Å `name`, `description`, `inputSchema`
- [ ] –ö–∞–∂–¥—ã–π `description` —Å–æ–¥–µ—Ä–∂–∏—Ç: **—á—Ç–æ –¥–µ–ª–∞–µ—Ç**, **—á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç**, **–∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**
- [ ] `POST /tools/call` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `result.content` (–¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö ‚Äî —Ç–µ–∫—Å—Ç–æ–º, –Ω–µ HTTP 500)
- [ ] `describe_platform` tool —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω ‚Äî –∞–≥–µ–Ω—Ç –∑–Ω–∞–µ—Ç —á—Ç–æ –∑–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- [ ] `describe_current_page` tool —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω ‚Äî –∞–≥–µ–Ω—Ç –∑–Ω–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- [ ] `<iframe>` —Å –ø–∞–Ω–µ–ª—å—é –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç-—Å—Ç—Ä–∞–Ω–∏—Ü–µ
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω–æ: `[MCP] Connected to ...` + —Å–ø–∏—Å–æ–∫ tools
- [ ] System prompt –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `?system=` –ø–∞—Ä–∞–º–µ—Ç—Ä

### üü° –£—Ä–æ–≤–µ–Ω—å 2 ‚Äî –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (4‚Äì8 —á–∞—Å–æ–≤)

–ê–≥–µ–Ω—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

- [ ] Skills (`trustchain:skills`) –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- [ ] App Actions –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è client-side UI-–æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] `trustchain:call_action` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ö–æ—Å—Ç-—Å—Ç—Ä–∞–Ω–∏—Ü–µ–π
- [ ] Actions –æ—á–∏—â–∞—é—Ç—Å—è –∏ –ø–µ—Ä–µ—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- [ ] Intent patterns –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è —Ç–æ—á–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] Domain hints –ø–µ—Ä–µ–¥–∞–Ω—ã –¥–ª—è —Ç–æ—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ LLM
- [ ] –°–ø–∏—Å–∫–æ–≤—ã–µ tools –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é (limit/offset)
- [ ] TrustChain `trustchain` –æ–±—ä–µ–∫—Ç –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º `tools/call`

### üî¥ –£—Ä–æ–≤–µ–Ω—å 3 ‚Äî –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

- [ ] Agent Config ‚Äî —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (`trustchain:agent_config`)
- [ ] TrustChain –ø–æ–¥–ø–∏—Å–∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è (Ed25519) –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ MCP Server
- [ ] Audit trail —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
- [ ] Playwright MCP –∑–∞–ø—É—â–µ–Ω –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- [ ] –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π greeting –∏ branding —á–µ—Ä–µ–∑ `trustchain:agent_config`

### Crypto Policy (strict profile)

- `algorithm`: —Ç–æ–ª—å–∫–æ `ed25519` (—Ä–µ–∂–∏–º `hmac-sha256` –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —è–≤–Ω–æ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º compat-—Ñ–ª–∞–≥–µ).
- `signature_schema_version`: –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º.
- `key_id`: –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è allowlist/rotation/revocation.
- `timestamp`: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –æ–∫–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏ (anti-replay/time-skew).
- `session_id + sequence`: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç—å –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å.
- `parent_signature`: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å —Ü–µ–ø–æ—á–∫–∏ –¥–ª—è Pro/Enterprise.

### Deny Codes (–µ–¥–∏–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç)

`POST /tools/call` –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `result.content[0].text` —Å JSON:

- `action: "deny"`
- `policy: <policy_name>`
- `code: <deny_code>`
- `message: <human_readable>`

–ë–∞–∑–æ–≤—ã–µ –∫–æ–¥—ã:

- `SIGNED_TRUSTCHAIN_REQUIRED` ‚Äî –º—É—Ç–∞—Ü–∏—è –±–µ–∑ `trustchain` envelope.
- `SCHEMA_VERSION_UNSUPPORTED` ‚Äî –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è `signature_schema_version`.
- `TIMESTAMP_SKEW` ‚Äî –≤—ã—Ö–æ–¥ –∑–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ.
- `UNTRUSTED_KEY_ID` / `UNTRUSTED_PUBKEY` / `REVOKED_KEY_ID` ‚Äî –∫–ª—é—á–µ–≤–æ–π –∫–æ–Ω—Ç—É—Ä.
- `REPLAY_DETECTED` / `CHAIN_BREAK` ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ sequence/—Ü–µ–ø–æ—á–∫–∏.
- `HUMAN_APPROVAL_REQUIRED` ‚Äî high-risk –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ human approval.

### –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è –æ—Ñ–ª–∞–π–Ω-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `audit_trail` –≤ JSON.
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `npm run trustchain:verify-proof -- ./audit.json`.
- –î–ª—è CI/CD provenance gate: `npm run trustchain:provenance-gate -- ./audit.json`.

### Decision Context Attestation

–î–ª—è high-risk —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ envelope –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω `decision_context`:
- `provider`, `model`, `policy_version`, `fallback_used`, `safety_mode`, `incident_flags`.
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `decision_context` –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ deny-path –Ω–∞ policy gate.

---

## Anti-patterns ‚Äî –ß–µ–≥–æ –ù–ï –¥–µ–ª–∞—Ç—å

| ‚ùå –ù–µ –¥–µ–ª–∞–π—Ç–µ | ‚úÖ –î–µ–ª–∞–π—Ç–µ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ |
|--------------|------------------------|
| –•–∞—Ä–¥–∫–æ–¥ tools –≤ –∫–æ–¥–µ –∞–≥–µ–Ω—Ç–∞ | –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ MCP Server |
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ built-in tools (web_search –∏ —Ç.–¥.) | –ê–≥–µ–Ω—Ç —É–∂–µ —É–º–µ–µ—Ç ‚Äî –Ω–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ |
| HTTP 500 –ø—Ä–∏ –æ—à–∏–±–∫–µ tool | –í–µ—Ä–Ω–∏—Ç–µ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –≤ `result.content` |
| –û–ø–∏—Å–∞–Ω–∏—è —Ç–∏–ø–∞ "–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ" | –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è: —á—Ç–æ, –∫–æ–≥–¥–∞, —Ñ–æ—Ä–º–∞—Ç –≤–æ–∑–≤—Ä–∞—Ç–∞ |
| –û–¥–∏–Ω –æ–≥—Ä–æ–º–Ω—ã–π tool –Ω–∞ –≤—Å—ë | –†–∞–∑–±–µ–π—Ç–µ –Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| System prompt –≤–Ω—É—Ç—Ä–∏ –∫–æ–¥–∞ –∞–≥–µ–Ω—Ç–∞ | –ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ —á–µ—Ä–µ–∑ `?system=` URL –ø–∞—Ä–∞–º–µ—Ç—Ä |

---

## Troubleshooting

| –°–∏–º–ø—Ç–æ–º | –†–µ—à–µ–Ω–∏–µ |
|---------|---------|
| –ê–≥–µ–Ω—Ç –Ω–µ –≤–∏–¥–∏—Ç tools | `curl -X POST http://localhost:7323/tools/list` ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–≤–µ—Ç |
| CORS –æ—à–∏–±–∫–∞ | –î–æ–±–∞–≤—å—Ç–µ CORS headers –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Vite proxy |
| Tools –≤–∏–¥–Ω—ã, –Ω–æ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ MCP Server, —Ñ–æ—Ä–º–∞—Ç `result.content` |
| –ê–≥–µ–Ω—Ç –ø—É—Ç–∞–µ—Ç—Å—è –≤ tools | –£–ª—É—á—à–∏—Ç–µ `description` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–µ–µ, –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ |
| –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö | –î–æ–±–∞–≤—å—Ç–µ `limit` –ø–∞—Ä–∞–º–µ—Ç—Ä, —Å–æ–∫—Ä–∞—Ç–∏—Ç–µ –æ—Ç–≤–µ—Ç –¥–æ <50 –ö–ë |
| –ü–∞–Ω–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è | `cd TrustChain_Agent && npm run dev` |
| App Action –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `trustchain:register_actions` –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω **–ø–æ—Å–ª–µ** –∑–∞–≥—Ä—É–∑–∫–∏ iframe |
| –ê–≥–µ–Ω—Ç –Ω–µ –≤–∏–¥–∏—Ç App Actions | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏: `[AppActionsRegistry] Registered N actions` |
| –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–∞—à–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ | –û—Ç–ø—Ä–∞–≤–∏–ª–∏ `trustchain:agent_config` **–¥–æ** –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞? |

---

**TrustChain Agent Integration Standard v3.1** ‚Ä¢ [Model Context Protocol](https://modelcontextprotocol.io/) ‚Ä¢ Ed25519 Cryptographic Verification + Nonce Replay Protection
