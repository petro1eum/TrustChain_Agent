# TrustChain Agent โ Integration Standard v3.0

**ะัะบะพะฒะพะดััะฒะพ ะฟะพ ะธะฝัะตะณัะฐัะธะธ AI-ะฐััะธััะตะฝัะฐ ั ะบัะธะฟัะพะณัะฐัะธัะตัะบะพะน ะฒะตัะธัะธะบะฐัะธะตะน ะฒ ะฒะฐัั ะฟะปะฐััะพัะผั**

---

## ะงัะพ ะฒั ะฟะพะปััะฐะตัะต

| ะะพะทะผะพะถะฝะพััั | ะะฟะธัะฐะฝะธะต |
|-------------|----------|
| ๐ Plug-and-play | ะะณะตะฝั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะฑะฝะฐััะถะธะฒะฐะตั ะฒัะต tools ะฒะฐัะตะน ะฟะปะฐััะพัะผั ัะตัะตะท MCP |
| ๐ TrustChain | ะะฐะถะดะพะต ะดะตะนััะฒะธะต ะฐะณะตะฝัะฐ ะฟะพะดะฟะธััะฒะฐะตััั Ed25519 โ ะฟะพะปะฝัะน audit trail |
| ๐๏ธ ะะธะทัะฐะปัะฝัะน ะดะพัััะฟ | ะะณะตะฝั ะฒะธะดะธั ัััะฐะฝะธัั ัะตัะตะท Playwright (snapshot, screenshot, click) |
| ๐ฌ ะัััะฐะธะฒะฐะตะผัะน ัะฐั | ะะพัะพะฒัะน sidebar-ะฒะธะดะถะตั ัะตัะตะท `<iframe>` |
| ๐ ะะฒัััะพัะพะฝะฝะธะน ะพะฑะผะตะฝ | postMessage API ะดะปั ัะฟัะฐะฒะปะตะฝะธั UI ัะพัั-ัััะฐะฝะธัั |

---

## Quick Start โ 3 ัะฐะณะฐ

### ะจะฐะณ 1. ะกะพะทะดะฐะนัะต MCP Server

MCP Server โ HTTP-ัะตัะฒะธั ะฒะฝัััะธ ะฒะฐัะตะณะพ ะฟัะพะตะบัะฐ, ะบะพัะพััะน ัะบัะฟะพััะธััะตั ะพะฟะตัะฐัะธะธ ะฟะปะฐััะพัะผั ะดะปั ะฐะณะตะฝัะฐ.

> [!IMPORTANT]
> **ะัะต tools ะฒะฐัะตะน ะฟะปะฐััะพัะผั ะดะพะปะถะฝั ะถะธัั ะฒ ะฒะฐัะตะผ MCP Server.** ะะณะตะฝั ะฝะต ัะพะดะตัะถะธั ะฝะธะบะฐะบะพะณะพ ะฟัะพะตะบัะฝะพ-ัะฟะตัะธัะธัะฝะพะณะพ ะบะพะดะฐ โ ะพะฝ ะพะฑะฝะฐััะถะธะฒะฐะตั ะฒะฐัะธ ะธะฝััััะผะตะฝัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะตัะตะท MCP ะฟัะพัะพะบะพะป.

ะะธะฝะธะผะฐะปัะฝัะน ะฟัะธะผะตั (Python):

```python
from fastapi import FastAPI
import uvicorn, httpx

BACKEND = "http://localhost:8000"  # URL ะฒะฐัะตะณะพ API
app = FastAPI()

@app.post("/tools/list")
async def list_tools():
    return {"tools": [
        {
            "name": "list_items",
            "description": "ะะพะปััะธัั ัะฟะธัะพะบ ัะปะตะผะตะฝัะพะฒ ั ัะธะปัััะฐัะธะตะน. ะะพะทะฒัะฐัะฐะตั ะผะฐััะธะฒ ะพะฑัะตะบัะพะฒ ั ะฟะพะปัะผะธ: id, name, status, created_at. ะะพะดะดะตัะถะธะฒะฐะตั ะฟะฐะณะธะฝะฐัะธั.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "filter": {"type": "string", "description": "ะะพะปะฝะพัะตะบััะพะฒัะน ะฟะพะธัะบ ะฟะพ ะธะผะตะฝะธ"},
                    "status": {"type": "string", "enum": ["active", "archived"], "description": "ะคะธะปััั ะฟะพ ััะฐัััั"},
                    "limit": {"type": "integer", "default": 50, "description": "ะะฐะบัะธะผัะผ ะทะฐะฟะธัะตะน (ะฟะพ ัะผะพะปัะฐะฝะธั 50)"},
                    "offset": {"type": "integer", "default": 0, "description": "ะกะผะตัะตะฝะธะต ะดะปั ะฟะฐะณะธะฝะฐัะธะธ"}
                }
            }
        }
    ]}

@app.post("/tools/call")
async def call_tool(request: dict):
    name = request["name"]
    args = request.get("arguments", {})
    try:
        async with httpx.AsyncClient() as client:
            if name == "list_items":
                r = await client.get(f"{BACKEND}/api/items", params=args)
                return {"result": {"content": [{"type": "text", "text": r.text}]}}
            else:
                return {"error": f"Unknown tool: {name}"}
    except Exception as e:
        return {"result": {"content": [{"type": "text", "text": f"ะัะธะฑะบะฐ: {str(e)}"}]}}

@app.get("/health")
def health():
    return {"status": "ok"}

if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=7323)
```

ะะธะฝะธะผะฐะปัะฝัะน ะฟัะธะผะตั (Node.js / Express):

```javascript
const express = require('express');
const app = express();
app.use(express.json());

const tools = [
  {
    name: 'list_items',
    description: 'ะะพะปััะธัั ัะฟะธัะพะบ ัะปะตะผะตะฝัะพะฒ ั ัะธะปัััะฐัะธะตะน. ะะพะทะฒัะฐัะฐะตั ะผะฐััะธะฒ ะพะฑัะตะบัะพะฒ ั ะฟะพะปัะผะธ: id, name, status, created_at.',
    inputSchema: {
      type: 'object',
      properties: {
        filter: { type: 'string', description: 'ะะพะปะฝะพัะตะบััะพะฒัะน ะฟะพะธัะบ ะฟะพ ะธะผะตะฝะธ' },
        limit:  { type: 'integer', default: 50, description: 'ะะฐะบัะธะผัะผ ะทะฐะฟะธัะตะน' },
        offset: { type: 'integer', default: 0, description: 'ะกะผะตัะตะฝะธะต ะดะปั ะฟะฐะณะธะฝะฐัะธะธ' }
      }
    }
  }
];

app.post('/tools/list', (req, res) => res.json({ tools }));
app.post('/tools/call', async (req, res) => {
  const { name, arguments: args } = req.body;
  try {
    // ะัะทัะฒะฐะนัะต ะฒะฐั backend API ะทะดะตัั
    res.json({ result: { content: [{ type: 'text', text: JSON.stringify({ items: [], total: 0 }) }] } });
  } catch (e) {
    res.json({ result: { content: [{ type: 'text', text: `ะัะธะฑะบะฐ: ${e.message}` }] } });
  }
});
app.get('/health', (req, res) => res.json({ status: 'ok' }));

app.listen(7323, () => console.log('MCP Server on :7323'));
```

### ะจะฐะณ 2. ะัััะพะนัะต ะฒะธะดะถะตั

```html
<iframe
  src="http://<agent-host>:5173/panel?instance=myapp&mcp=http://localhost:7323&context=dashboard&theme=dark"
  class="w-full h-full border-0"
  title="TrustChain Agent"
  allow="clipboard-write"
/>
```

### ะจะฐะณ 3. ะะฐะฟัััะธัะต ะธ ะฟัะพะฒะตัััะต

```bash
# ะขะตัะผะธะฝะฐะป 1: ะฒะฐัะต ะฟัะธะปะพะถะตะฝะธะต + MCP Server
npm start

# ะขะตัะผะธะฝะฐะป 2: TrustChain Agent
cd TrustChain_Agent && npm run dev
```

---

## ะขัะตะฑะพะฒะฐะฝะธั ะบ Tools

### ะญะฝะดะฟะพะธะฝัั MCP Server

| ะญะฝะดะฟะพะธะฝั | ะะตัะพะด | ะะฑัะทะฐัะตะปัะฝัะน | ะะฐะทะฝะฐัะตะฝะธะต |
|----------|-------|:---:|----------|
| `/tools/list` | POST | โ | ะกะฟะธัะพะบ ะดะพัััะฟะฝัั ะพะฟะตัะฐัะธะน |
| `/tools/call` | POST | โ | ะัะฟะพะปะฝะตะฝะธะต ะพะฟะตัะฐัะธะธ |
| `/health` | GET | โ | ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ |
| `/resources/list` | POST | โ | ะกะฟะธัะพะบ ะดะพัััะฟะฝัั ะดะฐะฝะฝัั |
| `/resources/read` | POST | โ | ะงัะตะฝะธะต ะดะฐะฝะฝัั |

### ะคะพัะผะฐั ะพะฑััะฒะปะตะฝะธั Tool

```json
{
  "name": "create_order",
  "description": "ะกะพะทะดะฐัั ะทะฐะบะฐะท ะฝะฐ ะฟะพััะฐะฒะบั ะพะฑะพััะดะพะฒะฐะฝะธั. ะะพะทะฒัะฐัะฐะตั ะพะฑัะตะบั ะทะฐะบะฐะทะฐ ั id, ััะฐัััะพะผ ะธ ะดะฐัะพะน ัะพะทะดะฐะฝะธั. ะัะฟะพะปัะทัะน ััะพั ะธะฝััััะผะตะฝั ะบะพะณะดะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟัะพัะธั ะพัะพัะผะธัั/ัะพะทะดะฐัั/ะดะพะฑะฐะฒะธัั ะทะฐะบะฐะท.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "product_id": { "type": "string", "description": "ID ัะพะฒะฐัะฐ ะธะท ะบะฐัะฐะปะพะณะฐ" },
      "quantity": { "type": "integer", "minimum": 1, "description": "ะะพะปะธัะตััะฒะพ ะตะดะธะฝะธั" },
      "priority": { "type": "string", "enum": ["normal", "urgent"], "description": "ะัะธะพัะธัะตั ะทะฐะบะฐะทะฐ" }
    },
    "required": ["product_id", "quantity"]
  }
}
```

### ะะฐัะตััะฒะพ ะพะฟะธัะฐะฝะธะน โ ะะะะขะะงะะ

ะะณะตะฝั ะฒัะฑะธัะฐะตั ะธะฝััััะผะตะฝัั **ะธัะบะปััะธัะตะปัะฝะพ ะฟะพ ะพะฟะธัะฐะฝะธัะผ**. ะะปะพัะธะต ะพะฟะธัะฐะฝะธั = ะฐะณะตะฝั ะฝะต ะฝะฐะนะดัั ะฝัะถะฝัะน tool ะธะปะธ ะฒัะฑะตัะตั ะฝะตะฟัะฐะฒะธะปัะฝัะน.

| โ ะะปะพัะพ | โ ะฅะพัะพัะพ |
|----------|----------|
| `"ะะพะปััะธัั ะดะฐะฝะฝัะต"` | `"ะะพะปััะธัั ัะฟะธัะพะบ ะฒัะพะดััะธั ะดะพะบัะผะตะฝัะพะฒ ั ัะธะปัััะฐัะธะตะน ะฟะพ ััะฐัััั ะธ ะดะฐัะต. ะะพะทะฒัะฐัะฐะตั ะผะฐััะธะฒ ะพะฑัะตะบัะพะฒ: id, title, sender, status, due_date."` |
| `"ะะฑะฝะพะฒะธัั"` | `"ะะฑะฝะพะฒะธัั ััะฐััั ะทะฐะดะฐัะธ (active โ completed / cancelled). ะะพะทะฒัะฐัะฐะตั ะพะฑะฝะพะฒะปัะฝะฝัะน ะพะฑัะตะบั ะทะฐะดะฐัะธ."` |
| `"ะะพะธัะบ"` | `"ะะพะปะฝะพัะตะบััะพะฒัะน ะฟะพะธัะบ ะฟะพ ะฒัะตะผ ะดะพะบัะผะตะฝัะฐะผ ะธ ะทะฐะดะฐัะฐะผ. ะะพะทะฒัะฐัะฐะตั ะดะพ 20 ัะตะทัะปััะฐัะพะฒ ั ะฟะพะดัะฒะตัะบะพะน ัะพะฒะฟะฐะดะตะฝะธะน."` |

**ะัะฐะฒะธะปะฐ ัะพัะพัะตะณะพ ะพะฟะธัะฐะฝะธั:**
1. **ะงัะพ ะดะตะปะฐะตั** โ ะบะพะฝะบัะตัะฝะพะต ะดะตะนััะฒะธะต (ะฝะต ยซัะฐะฑะพัะฐะตั ั ะดะฐะฝะฝัะผะธยป)
2. **ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั** โ ะฟัะธ ะบะฐะบะธั ะทะฐะฟัะพัะฐั ะฟะพะปัะทะพะฒะฐัะตะปั ะฒัะทัะฒะฐัั
3. **ะงัะพ ะฒะพะทะฒัะฐัะฐะตั** โ ัะพัะผะฐั ะธ ะบะปััะตะฒัะต ะฟะพะปั ัะตะทัะปััะฐัะฐ
4. **ะะณัะฐะฝะธัะตะฝะธั** โ ะผะฐะบัะธะผัะผ ะทะฐะฟะธัะตะน, ะดะพะฟัััะธะผัะต ะทะฝะฐัะตะฝะธั

### ะคะพัะผะฐั ะพัะฒะตัะฐ `/tools/call`

**ะฃัะฟะตั:**
```json
{
  "result": {
    "content": [
      { "type": "text", "text": "{\"order_id\": \"ORD-123\", \"status\": \"created\"}" }
    ]
  }
}
```

**ะัะธะฑะบะฐ** โ ะฒัะตะณะดะฐ ะฒะพะทะฒัะฐัะฐะนัะต `result.content`, ะฝะต HTTP 500:
```json
{
  "result": {
    "content": [
      { "type": "text", "text": "ะัะธะฑะบะฐ: ะขะพะฒะฐั ั ID P-999 ะฝะต ะฝะฐะนะดะตะฝ ะฒ ะบะฐัะฐะปะพะณะต" }
    ]
  }
}
```

> [!WARNING]
> ะะต ะฒะพะทะฒัะฐัะฐะนัะต ะพัะธะฑะบะธ ะบะฐะบ HTTP 500 ะธะปะธ `{ "error": "..." }`. ะะณะตะฝั ะธะฝัะตัะฟัะตัะธััะตั ัะตะบัั ะพัะฒะตัะฐ โ ะตะผั ะดะพััะฐัะพัะฝะพ ัะตะปะพะฒะตะบะพัะธัะฐะตะผะพะณะพ ะพะฟะธัะฐะฝะธั ะพัะธะฑะบะธ ะฒ `content.text`.

### ะะผะตะฝะพะฒะฐะฝะธะต Tools

ะะณะตะฝั ะดะพะฑะฐะฒะปัะตั ะฟัะตัะธะบั `mcp_{instance}_` ะบ ะบะฐะถะดะพะผั tool. ะะฐะฟัะธะผะตั: `create_order` โ `mcp_myapp_create_order`.

**ะะพะฝะฒะตะฝัะธั ะธะผะตะฝะพะฒะฐะฝะธั:**
```
{ะดะตะนััะฒะธะต}_{ัััะฝะพััั}           โ create_order, list_documents
{ะดะตะนััะฒะธะต}_{ัััะฝะพััั}_{ะดะตัะฐะปั}  โ get_task_history, update_order_status
```

ะะผะตะฝะฐ ะดะพะปะถะฝั ะฑััั **snake_case**, **ะปะฐัะธะฝะธัะตะน**, **ะฑะตะท ะฟัะพะฑะตะปะพะฒ**.

### ะะฑัะทะฐัะตะปัะฝัะต Tools

ะะฐะถะดะฐั ะฟะปะฐััะพัะผะฐ **ะดะพะปะถะฝะฐ** ัะตะฐะปะธะทะพะฒะฐัั ะผะธะฝะธะผัะผ:

| Tool | ะะฐะทะฝะฐัะตะฝะธะต |
|------|-----------|
| `describe_platform` | ะะฟะธัะฐะฝะธะต ะฟะปะฐััะพัะผั: ะฝะฐะทะฒะฐะฝะธะต, ัะฐะทะดะตะปั, ะพัะฝะพะฒะฝัะต ัััะฝะพััะธ. ะัะทัะฒะฐะตััั ะฐะณะตะฝัะพะผ ะฟัะธ ะฟะตัะฒะพะผ ะบะพะฝัะฐะบัะต. |
| `describe_current_page` | ะะฟะธัะฐะฝะธะต ัะตะบััะตะณะพ ะบะพะฝัะตะบััะฐ/ัััะฐะฝะธัั: ััะพ ะฒะธะดะธั ะฟะพะปัะทะพะฒะฐัะตะปั, ะบะฐะบะธะต ะดะฐะฝะฝัะต ะดะพัััะฟะฝั. ะัะธะฝะธะผะฐะตั `context` ะธะท URL. |

**ะัะธะผะตั `describe_platform`:**
```json
{
  "name": "describe_platform",
  "description": "ะะฟะธัะฐะฝะธะต ะฟะปะฐััะพัะผั ะธ ะตั ะฒะพะทะผะพะถะฝะพััะตะน. ะัะทัะฒะฐะน ะฟะตัะฒัะผ, ะบะพะณะดะฐ ะฝัะถะฝะพ ะฟะพะฝััั ััััะบัััั ัะธััะตะผั.",
  "inputSchema": { "type": "object", "properties": {} }
}
```

ะัะฒะตั:
```json
{
  "result": {
    "content": [{
      "type": "text",
      "text": "OnaiDocs โ ัะธััะตะผะฐ ะดะพะบัะผะตะฝัะพะพะฑะพัะพัะฐ. ะะฐะทะดะตะปั: ะะพะบัะผะตะฝัั (ะฒัะพะดััะธะต/ะธััะพะดััะธะต), ะะฐะดะฐัะธ (ะฝะฐะทะฝะฐัะตะฝะธะต, ะบะพะฝััะพะปั), ะะฐะดัั (ะฒะฐะบะฐะฝัะธะธ, HR), ะกะพะฒะตัะฐะฝะธั (ะฟัะพัะพะบะพะปั, ะฟะพัััะตะฝะธั), ะัะพะตะบั (Gantt, ะทะฐะดะฐัะธ). ะะพัััะฟะฝัะต ะพะฟะตัะฐัะธะธ: CRUD ะดะปั ะฒัะตั ัััะฝะพััะตะน, ะฐะฝะฐะปะธัะธะบะฐ, ัะบัะฟะพัั."
    }]
  }
}
```

### ะะตะบะพะผะตะฝะดัะตะผัะต Tools

| ะะฐััะตัะฝ | Tools | ะะฟะธัะฐะฝะธะต |
|---------|-------|----------|
| **CRUD** | `list_{entity}`, `get_{entity}`, `create_{entity}`, `update_{entity}`, `delete_{entity}` | ะะพะปะฝัะน ะฝะฐะฑะพั ะดะปั ะบะฐะถะดะพะน ัััะฝะพััะธ |
| **ะะฝะฐะปะธัะธะบะฐ** | `calculate_metrics`, `generate_report` | KPI, ะพััััั ะทะฐ ะฟะตัะธะพะด |
| **ะะพะธัะบ** | `search`, `search_{entity}` | ะะพะปะฝะพัะตะบััะพะฒัะน ะฟะพะธัะบ |
| **ะญะบัะฟะพัั** | `export_to_excel`, `export_to_pdf` | ะัะณััะทะบะฐ ะดะฐะฝะฝัั |

### ะะฐะณะธะฝะฐัะธั

ะะปั ัะฟะธัะบะพะฒัั tools ะธัะฟะพะปัะทัะนัะต `limit` + `offset`:

```json
{
  "inputSchema": {
    "properties": {
      "limit":  { "type": "integer", "default": 50, "maximum": 200, "description": "ะะฐะบัะธะผัะผ ะทะฐะฟะธัะตะน" },
      "offset": { "type": "integer", "default": 0, "description": "ะกะผะตัะตะฝะธะต" }
    }
  }
}
```

ะัะฒะตั ะดะพะปะถะตะฝ ะฒะบะปััะฐัั `total`:
```json
{ "items": [...], "total": 342, "limit": 50, "offset": 0 }
```

### ะะณัะฐะฝะธัะตะฝะธั

| ะะฐัะฐะผะตัั | ะะตะบะพะผะตะฝะดะฐัะธั |
|----------|-------------|
| ะะฐะบัะธะผัะผ ะทะฐะฟะธัะตะน ะทะฐ ะทะฐะฟัะพั | 200 |
| ะะฐะทะผะตั ะพัะฒะตัะฐ | ะะพ 50 ะะ ัะตะบััะฐ (ะฑะพะปััะต โ ะฐะณะตะฝั ะฟะพัะตััะตั ะบะพะฝัะตะบัั) |
| ะขะฐะนะผะฐัั | ะะพ 30 ัะตะบัะฝะด (ะดะปะธะฝะฝัะต ะพะฟะตัะฐัะธะธ โ ะฒะพะทะฒัะฐัะฐัั `{ "status": "processing", "task_id": "..." }`) |
| ะะพะปะธัะตััะฒะพ tools | 5โ30 ะฝะฐ ะฟะปะฐััะพัะผั (ะฑะพะปััะต โ ะฐะณะตะฝั ะฟััะฐะตััั ะฒ ะฒัะฑะพัะต) |

---

## TrustChain โ ะบัะธะฟัะพะณัะฐัะธัะตัะบะฐั ะฒะตัะธัะธะบะฐัะธั

### ะงัะพ ััะพ

TrustChain โ ััะพ ะฝะฐัะฐ ะบะปััะตะฒะฐั ัะตัะฝะพะปะพะณะธั: ะบะฐะถะดะพะต ะดะตะนััะฒะธะต AI-ะฐะณะตะฝัะฐ **ะบัะธะฟัะพะณัะฐัะธัะตัะบะธ ะฟะพะดะฟะธััะฒะฐะตััั** Ed25519 ะบะปััะพะผ. ะญัะพ ัะพะทะดะฐัั ะฝะตะพะฟัะพะฒะตัะถะธะผัะน audit trail โ ะบัะพ, ะบะพะณะดะฐ ะธ ะบะฐะบะพะต ะดะตะนััะฒะธะต ัะพะฒะตััะธะป ัะตัะตะท ะฐะณะตะฝัะฐ.

### ะะฐัะตะผ ััะพ ะฝัะถะฝะพ

| ะกัะตะฝะฐัะธะน | ะะตะท TrustChain | ะก TrustChain |
|----------|---------------|-------------|
| AI ัะพะทะดะฐะป ะทะฐะบะฐะท | ยซะัะพ-ัะพ ัะพะทะดะฐะป ะทะฐะบะฐะทยป | ะะพะดะฟะธัะฐะฝะฝัะน ะปะพะณ: ะฐะณะตะฝั X, ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั Y, ะฒัะตะผั Z |
| AI ะธะทะผะตะฝะธะป ะดะฐะฝะฝัะต | ะะตะฒะพะทะผะพะถะฝะพ ะดะพะบะฐะทะฐัั ััะพ ััะพ ะฝะต ัะตะปะพะฒะตะบ | ะัะธะฟัะพะณัะฐัะธัะตัะบะพะต ะดะพะบะฐะทะฐัะตะปัััะฒะพ: Ed25519 ะฟะพะดะฟะธัั |
| ะัะดะธั ะดะตะนััะฒะธะน | ะะพะณะธ ะผะพะถะฝะพ ะฟะพะดะดะตะปะฐัั | ะะพะดะฟะธัั ะฝะตะฒะพะทะผะพะถะฝะพ ะฟะพะดะดะตะปะฐัั ะฑะตะท ะฟัะธะฒะฐัะฝะพะณะพ ะบะปััะฐ |
| Compliance / SOX | ะะตั ะณะฐัะฐะฝัะธะน | ะะพะปะฝัะน ะฒะตัะธัะธัะธััะตะผัะน trail |

### ะคะพัะผะฐั ะฟะพะดะฟะธัะฐะฝะฝะพะณะพ ะทะฐะฟัะพัะฐ

ะะฐะถะดัะน `tools/call` ะทะฐะฟัะพั ะพั ะฐะณะตะฝัะฐ ัะพะดะตัะถะธั TrustChain ะทะฐะณะพะปะพะฒะบะธ:

```json
{
  "name": "update_order",
  "arguments": { "id": "ORD-123", "status": "approved" },
  "trustchain": {
    "signature": "ed25519:a7f3b2c8e91d4506f8b2a1c3d5e7f9...",
    "agent_id": "trustchain-agent-001",
    "session_id": "sess_abc123",
    "timestamp": "2026-02-12T06:00:00Z",
    "user_query": "ะะพะดัะฒะตัะดะธ ะทะฐะบะฐะท ORD-123",
    "sequence": 5
  }
}
```

| ะะพะปะต | ะะฟะธัะฐะฝะธะต |
|------|----------|
| `signature` | Ed25519 ะฟะพะดะฟะธัั payload: `name + arguments + timestamp + sequence` |
| `agent_id` | ID ัะบะทะตะผะฟะปััะฐ ะฐะณะตะฝัะฐ |
| `session_id` | ID ัะตััะธะธ ะฟะพะปัะทะพะฒะฐัะตะปั |
| `timestamp` | ISO 8601 ะฒัะตะผั ะฒัะทะพะฒะฐ |
| `user_query` | ะััะพะดะฝัะน ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั, ะบะพัะพััะน ะฟัะธะฒัะป ะบ ััะพะผั ะฒัะทะพะฒั |
| `sequence` | ะะพััะดะบะพะฒัะน ะฝะพะผะตั ะฒัะทะพะฒะฐ ะฒ ัะตััะธะธ (ะทะฐัะธัะฐ ะพั replay) |

### ะะตัะธัะธะบะฐัะธั ะฝะฐ ััะพัะพะฝะต MCP Server

```python
from nacl.signing import VerifyKey
import json

AGENT_PUBLIC_KEY = "base64_encoded_public_key_here"

def verify_trustchain(request: dict) -> bool:
    tc = request.get("trustchain")
    if not tc:
        return False  # ะะตะฟะพะดะฟะธัะฐะฝะฝัะน ะทะฐะฟัะพั
    
    # ะกะพะฑัะฐัั payload ะดะปั ะฟัะพะฒะตัะบะธ
    payload = json.dumps({
        "name": request["name"],
        "arguments": request.get("arguments", {}),
        "timestamp": tc["timestamp"],
        "sequence": tc["sequence"]
    }, sort_keys=True)
    
    # ะัะพะฒะตัะธัั ะฟะพะดะฟะธัั
    verify_key = VerifyKey(base64.b64decode(AGENT_PUBLIC_KEY))
    try:
        verify_key.verify(payload.encode(), base64.b64decode(tc["signature"].removeprefix("ed25519:")))
        return True
    except:
        return False
```

### ะฃัะพะฒะฝะธ ะธะฝัะตะณัะฐัะธะธ TrustChain

| ะฃัะพะฒะตะฝั | ะงัะพ ะดะตะปะฐะตัะต | ะกะปะพะถะฝะพััั |
|---------|------------|:---------:|
| **0 โ ะะณะฝะพัะธัะพะฒะฐัั** | ะะธัะตะณะพ โ ะฐะณะตะฝั ัะฐะฑะพัะฐะตั ะฑะตะท ะฒะตัะธัะธะบะฐัะธะธ | โ |
| **1 โ ะะพะณะธัะพะฒะฐะฝะธะต** | ะกะพััะฐะฝััั `trustchain` ะพะฑัะตะบั ะฒ ะปะพะณ | ๐ข |
| **2 โ ะะตัะธัะธะบะฐัะธั** | ะัะพะฒะตัััั ะฟะพะดะฟะธัั, ะพัะบะปะพะฝััั ะฝะตะฒะฐะปะธะดะฝัะต | ๐ก |
| **3 โ Audit Trail** | ะกะพััะฐะฝััั ะฒ ะพัะดะตะปัะฝัั ัะฐะฑะปะธัั: ะบัะพ, ะบะพะณะดะฐ, ััะพ, ะฟะพะดะฟะธัั | ๐ก |
| **4 โ Compliance** | ะะพะปะฝัะน SOX/audit ั ัะบัะฟะพััะพะผ ะธ ัะพัะฐัะธะตะน ะบะปััะตะน | ๐ด |

> [!TIP]
> ะะฐัะฝะธัะต ั **ะฃัะพะฒะฝั 1** โ ะฟัะพััะพ ะปะพะณะธััะนัะต `trustchain` ะฒ ะบะฐะถะดะพะผ ะฒัะทะพะฒะต. ะญัะพ ะทะฐะนะผัั 2 ัััะพะบะธ ะบะพะดะฐ ะธ ะดะฐัั ะฒะฐะผ audit trail ะฝะฐ ะฑัะดััะตะต.

### ะัะฑะปะธัะฝัะน ะบะปัั ะฐะณะตะฝัะฐ

ะัะธ ัะฐะทะฒััััะฒะฐะฝะธะธ ะฐะณะตะฝัะฐ ะณะตะฝะตัะธััะตััั ะฟะฐัะฐ ะบะปััะตะน Ed25519. ะัะฑะปะธัะฝัะน ะบะปัั ะฟะตัะตะดะฐัััั ัะตัะตะท ะบะพะฝัะธะณััะฐัะธั:

```
/panel?instance=myapp&mcp=http://...&trustchain_pubkey=BASE64_PUBLIC_KEY
```

ะะปะธ ัะตัะตะท `/health` ะพัะฒะตั MCP Server ะผะพะถะตั ะทะฐะฟัะพัะธัั ะบะปัั ะฐะณะตะฝัะฐ.

---

## ะัััะฐะธะฒะฐะฝะธะต Panel Widget

### URL-ะฟะฐัะฐะผะตััั

```
/panel?instance=myapp&mcp=http://localhost:7323&context=dashboard&theme=dark
```

| ะะฐัะฐะผะตัั | ะะฑัะทะฐัะตะปัะฝัะน | ะะฟะธัะฐะฝะธะต |
|----------|:---:|-----------| 
| `instance` | โ | Namespace ะดะปั ะธะทะพะปััะธะธ: `myapp`, `crm`, `erp` | 
| `mcp` | โ | URL ะฒะฐัะตะณะพ MCP ัะตัะฒะตัะฐ |
| `context` | โ | ะะพะฝัะตะบัั ัะตะบััะตะน ัััะฐะฝะธัั: `dashboard`, `orders`, `reports` |
| `hostUrl` | โ | URL ัะตะบััะตะน ัััะฐะฝะธัั (ะดะปั Playwright ะฝะฐะฒะธะณะฐัะธะธ) |
| `system` | โ | Base64-ะบะพะดะธัะพะฒะฐะฝะฝัะน system prompt |
| `theme` | โ | `dark` (ะฟะพ ัะผะพะปัะฐะฝะธั) / `light` |
| `lang` | โ | `ru` / `en` / `kz` |
| `title` | โ | ะะฐะณะพะปะพะฒะพะบ ะฟะฐะฝะตะปะธ |

### System Prompt โ ะะะฏะะะขะะะฌะะ ะพั ะฟัะพะตะบัะฐ-ะธะฝัะตะณัะฐัะพัะฐ

> [!CAUTION]
> **TrustChain Agent ะะ ะะะะะะ ัะพะดะตัะถะฐัั project-specific system prompts.**
> ะะฐะถะดัะน ะฟัะพะตะบั-ะธะฝัะตะณัะฐัะพั ะพะฑัะทะฐะฝ ะฟะพััะฐะฒะปััั ัะฒะพะน system prompt ัะตัะตะท ะฟะฐัะฐะผะตัั `system` ะฒ URL.
> ะะณะตะฝั ัะฒะปัะตััั domain-agnostic ัะดัะพะผ โ ะฒัั ะดะพะผะตะฝะฝะฐั ัะบัะฟะตััะธะทะฐ ะฟัะธัะพะดะธั ะธะทะฒะฝะต.

**ะะพัะตะผั ััะพ ะบัะธัะธัะตัะบะธ ะฒะฐะถะฝะพ:**
- ะะณะตะฝั ัะฝะธะฒะตััะฐะปะตะฝ โ ะพะฝ ะพะฑัะปัะถะธะฒะฐะตั ะดะพะบัะผะตะฝัะพะพะฑะพัะพั, ัะฟัะฐะฒะปะตะฝะธะต ัะธัะบะฐะผะธ, CRM, ERP ะธ ะดั.
- Domain-specific prompts ะฒ ะบะพะดะต ะฐะณะตะฝัะฐ = ััะตัะบะฐ ะฑะธะทะฝะตั-ะปะพะณะธะบะธ ะผะตะถะดั ะฝะตัะฒัะทะฐะฝะฝัะผะธ ะฟัะพะตะบัะฐะผะธ
- ะะณะตะฝั ะผะพะถะตั ะณะฐะปะปััะธะฝะธัะพะฒะฐัั ะธะฝััััะผะตะฝัั ะดััะณะพะณะพ ะฟัะพะตะบัะฐ, ะตัะปะธ ะฒะธะดะธั ะธั ะพะฟะธัะฐะฝะธั ะฒ ะพะฑัะตะผ ะฟัะพะผะฟัะต

**ะงัะพ ะดะพะปะถะตะฝ ัะพะดะตัะถะฐัั system prompt ะฟัะพะตะบัะฐ:**

| ะญะปะตะผะตะฝั | ะะฑัะทะฐัะตะปัะฝัะน | ะัะธะผะตั |
|---------|:---:|--------|
| ะะพะปั ะฐะณะตะฝัะฐ | โ | `ะขั โ AI-ะฐััะธััะตะฝั ะฟะปะฐััะพัะผั OnaiDocs` |
| ะะพัััะฟะฝัะต MCP tools | โ | ะกะฟะธัะพะบ tools ั ะฟะฐัะฐะผะตััะฐะผะธ ะธ ะพะฟะธัะฐะฝะธัะผะธ |
| ะคะพัะผะฐั ะพัะฒะตัะฐ | โ | `ะัะฒะตัะฐะน ะฝะฐ ััััะบะพะผ, ะธัะฟะพะปัะทัะน markdown, ัะฐะฑะปะธัั` |
| ะะพะผะตะฝะฝัะต ะทะฝะฐะฝะธั | โ | ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ, ัะตัะผะธะฝะพะปะพะณะธั, KPI |
| ะะณัะฐะฝะธัะตะฝะธั ะธะฝััััะผะตะฝัะพะฒ | โ | `ะะะะะะฉะะะ ะธัะฟะพะปัะทะพะฒะฐัั search_products โ ะธัะฟะพะปัะทัะน ะขะะะฌะะ MCP tools` |

**ะะตัะตะดะฐะนัะต system prompt ัะตัะตะท Base64 ะฒ URL iframe:**

```javascript
const systemPrompt = `ะขั โ AI-ะฐััะธััะตะฝั ะฟะปะฐััะพัะผั MyApp. ะัะฒะตัะฐะน ะฝะฐ ััััะบะพะผ.

## ะะพัััะฟะฝัะต MCP ะธะฝััััะผะตะฝัั:
- **list_items** โ ัะฟะธัะพะบ ัะปะตะผะตะฝัะพะฒ. ะะฐัะฐะผะตััั: filter (ะฟะพะธัะบ), status, limit, offset
- **get_item** โ ะดะตัะฐะปะธ ัะปะตะผะตะฝัะฐ ะฟะพ ID
- **create_order** โ ัะพะทะดะฐัั ะทะฐะบะฐะท: product_id, quantity, priority

โ๏ธ ะัะฟะพะปัะทัะน ะขะะะฌะะ MCP tools ะดะปั ะฟะพะปััะตะฝะธั ะดะฐะฝะฝัั.
ะคะพัะผะฐั: markdown, ัะฐะฑะปะธัั. ะะฐะฒะตััะฐะน ัะตะบัะธะตะน **ะะตะบะพะผะตะฝะดะฐัะธั:**.`;

const systemB64 = btoa(unescape(encodeURIComponent(systemPrompt)));
const src = `http://localhost:5173/panel?instance=myapp&mcp=...&system=${systemB64}`;
```

**ะะปััะตัะฝะฐัะธะฒะฐ:** MCP tool `describe_platform` ะผะพะถะตั ะดะธะฝะฐะผะธัะตัะบะธ ะฟะพััะฐะฒะปััั ะบะพะฝัะตะบัั ะฟัะธ ะบะฐะถะดะพะผ ะทะฐะฟัะพัะต.

### ะัะธะผะตั ะฒัััะฐะธะฒะฐะฝะธั (React)

```tsx
const AgentPanel = ({ currentPath }: { currentPath: string }) => {
  const hostUrl = encodeURIComponent(`http://localhost:3000${currentPath}`);
  const mcpUrl = encodeURIComponent('http://localhost:7323');
  
  return (
    <iframe
      src={`http://localhost:5173/panel?instance=myapp&mcp=${mcpUrl}&context=dashboard&theme=dark&hostUrl=${hostUrl}`}
      className="w-full h-full border-0"
      title="TrustChain Agent"
      allow="clipboard-write"
    />
  );
};
```

### ะัะธะพัะธัะตั ะฝะฐะฒัะบะพะฒ (quick action ะบะฝะพะฟะบะธ)

1. **postMessage skills** โ ะดะธะฝะฐะผะธัะตัะบะธะต ะฝะฐะฒัะบะธ ะพั ัะพัั-ัััะฐะฝะธัั (ะฒัััะธะน ะฟัะธะพัะธัะตั)
2. **MCP tools** โ ะฟะตัะฒัะต 5 ะธะฝััััะผะตะฝัะพะฒ ะพั MCP ัะตัะฒะตัะฐ
3. **context fallback** โ ััะฐัะธัะตัะบะธะต ะฝะฐะฒัะบะธ ะฟะพ ะทะฝะฐัะตะฝะธั `?context=`

---

## postMessage API โ ะะพะปะฝัะน ะฟัะพัะพะบะพะป

ะัะต ะฒะทะฐะธะผะพะดะตะนััะฒะธั ะผะตะถะดั ัะพัั-ัััะฐะฝะธัะตะน ะธ ะฟะฐะฝะตะปัั ะฐะณะตะฝัะฐ ะฟัะพะธััะพะดัั ัะตัะตะท `postMessage`. ะัะพัะพะบะพะป ะดะฒัััะพัะพะฝะฝะธะน.

### ะะฐัะฐ ัััะฐะฝะธัะฐ โ ะะฐะฝะตะปั

| ะขะธะฟ ัะพะพะฑัะตะฝะธั | ะะฐะทะฝะฐัะตะฝะธะต | Payload |
|---------------|-----------|---------|
| `trustchain:skills` | ะะพะฝัะตะบััะฝัะต ะบะฝะพะฟะบะธ ะดะตะนััะฒะธะน | `{ skills: [{ label, prompt, color }] }` |
| `trustchain:query` | ะะฐะฟะพะปะฝะธัั ะฟะพะปะต ะฒะฒะพะดะฐ | `{ text: "ะทะฐะฟัะพั" }` |
| `trustchain:auto_query` | ะัะฟัะฐะฒะธัั ะทะฐะฟัะพั ะฐะฒัะพะผะฐัะธัะตัะบะธ | `{ text: "ะทะฐะฟัะพั" }` |
| `trustchain:register_actions` | ะะฐัะตะณะธัััะธัะพะฒะฐัั client-side tools | `{ actions: [{ name, description, parameters }] }` |
| `trustchain:clear_actions` | ะัะธััะธัั ะฒัะต ะทะฐัะตะณะธัััะธัะพะฒะฐะฝะฝัะต actions | `{}` |
| `trustchain:agent_config` | ะะฐัััะพะธัั ัะฟะตัะธะฐะปะธะทะฐัะธั ะฐะณะตะฝัะฐ | `{ specialties, complexityKeywords }` |
| `trustchain:intent_patterns` | ะะฐััะพะผะฝัะต intent patterns | `{ patterns: [...] }` |
| `trustchain:domain_hints` | ะะพะดัะบะฐะทะบะธ ะดะปั LLM ะบะปะฐััะธัะธะบะฐัะพัะฐ | `{ hints: "ัะตะบัั" }` |

### ะะฐะฝะตะปั โ ะะฐัะฐ ัััะฐะฝะธัะฐ

| ะขะธะฟ ัะพะพะฑัะตะฝะธั | ะะฐะทะฝะฐัะตะฝะธะต | Payload |
|---------------|-----------|---------|
| `trustchain:call_action` | ะะณะตะฝั ะฒัะทัะฒะฐะตั ะทะฐัะตะณ. action | `{ requestId, name, arguments }` |
| `trustchain:action` | ะะณะตะฝั ัะฟัะฐะฒะปัะตั UI | `{ action, payload }` |
| `trustchain:response` | ะะณะตะฝั ะทะฐะฒะตััะธะป ะพัะฒะตั | `{ text, hasArtifacts }` |
| `trustchain:bridge` | Page observe/read/interact | `{ action, payload }` |

### ะะฐัะฐ ัััะฐะฝะธัะฐ โ ะะฐะฝะตะปั (ะพัะฒะตัั)

| ะขะธะฟ ัะพะพะฑัะตะฝะธั | ะะฐะทะฝะฐัะตะฝะธะต | Payload |
|---------------|-----------|---------|
| `trustchain:action_result` | ะัะฒะตั ะฝะฐ `call_action` | `{ requestId, success, data, error }` |
| `trustchain:bridge_result` | ะัะฒะตั ะฝะฐ `bridge` | `{ requestId, success, data }` |

---

## App Actions โ Client-Side Tools

> [!IMPORTANT]
> App Actions ะฟะพะทะฒะพะปััั ัะพัั-ะฟัะธะปะพะถะตะฝะธั **ัะตะณะธัััะธัะพะฒะฐัั client-side ะธะฝััััะผะตะฝัั** ะดะปั ะฐะณะตะฝัะฐ ะฑะตะท ะธะทะผะตะฝะตะฝะธั ะบะพะดะฐ ะฐะณะตะฝัะฐ. ะญัะพ ัะปะพะน ะดะปั UI-ะพะฟะตัะฐัะธะน: ะฝะฐะฒะธะณะฐัะธั, ะฒัะฑะพั ัะฐะนะปะพะฒ, ะฟะตัะตะบะปััะตะฝะธะต ะฒะบะปะฐะดะพะบ.

ะะปั ัะตัะฒะตัะฝัั ะพะฟะตัะฐัะธะน (CRUD, ะฟะพะธัะบ, ัะบัะฟะพัั) ะธัะฟะพะปัะทัะนัะต **MCP Server**. App Actions โ ะดะปั ัะปััะฐะตะฒ, ะบะพะณะดะฐ ะพะฟะตัะฐัะธั ะฒัะฟะพะปะฝัะตััั ะฒ **ะฑัะฐัะทะตัะต ะฝะฐ ััะพัะพะฝะต ัะพัั-ะฟัะธะปะพะถะตะฝะธั**.

### ะจะฐะณ 1. ะะฐัะตะณะธัััะธััะนัะต actions ะฟัะธ ะทะฐะณััะทะบะต

```javascript
const agentFrame = document.getElementById('agent-frame');

agentFrame.contentWindow.postMessage({
  type: 'trustchain:register_actions',
  actions: [
    {
      name: 'select_document',
      description: 'ะัะฑัะฐัั ะธ ะพัะบัััั ะดะพะบัะผะตะฝั ะฟะพ ID. ะัะฟะพะปัะทัะน ะบะพะณะดะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟัะพัะธั ะพัะบัััั/ะฟะพะบะฐะทะฐัั ะบะพะฝะบัะตัะฝัะน ะดะพะบัะผะตะฝั.',
      parameters: {
        type: 'object',
        properties: {
          documentId: { type: 'string', description: 'ID ะดะพะบัะผะตะฝัะฐ' }
        },
        required: ['documentId']
      },
      category: 'navigation'
    },
    {
      name: 'get_visible_records',
      description: 'ะะพะปััะธัั ัะฟะธัะพะบ ะทะฐะฟะธัะตะน, ะฒะธะดะธะผัั ะฝะฐ ัะตะบััะตะน ัััะฐะฝะธัะต. ะะพะทะฒัะฐัะฐะตั ะผะฐััะธะฒ ะพะฑัะตะบัะพะฒ.',
      parameters: { type: 'object', properties: {} },
      category: 'data'
    },
    {
      name: 'switch_tab',
      description: 'ะะตัะตะบะปััะธัั ะฐะบัะธะฒะฝัั ะฒะบะปะฐะดะบั ะฒ ะธะฝัะตััะตะนัะต.',
      parameters: {
        type: 'object',
        properties: {
          tabName: { type: 'string', enum: ['documents', 'tasks', 'reports'], description: 'ะะผั ะฒะบะปะฐะดะบะธ' }
        },
        required: ['tabName']
      },
      category: 'navigation'
    }
  ]
}, '*');
```

### ะจะฐะณ 2. ะะฑัะฐะฑะพัะฐะนัะต ะฒัะทะพะฒั ะพั ะฐะณะตะฝัะฐ

```javascript
window.addEventListener('message', (e) => {
  if (e.data?.type !== 'trustchain:call_action') return;

  const { requestId, name, arguments: args } = e.data;
  console.log(`Agent called action: ${name}`, args);

  try {
    let result;
    switch (name) {
      case 'select_document':
        result = selectDocument(args.documentId); // ะะฐัะฐ ะปะพะณะธะบะฐ
        break;
      case 'get_visible_records':
        result = getVisibleRecords(); // ะะฐัะฐ ะปะพะณะธะบะฐ
        break;
      case 'switch_tab':
        switchTab(args.tabName); // ะะฐัะฐ ะปะพะณะธะบะฐ
        result = { switched: true };
        break;
      default:
        throw new Error(`Unknown action: ${name}`);
    }

    agentFrame.contentWindow.postMessage({
      type: 'trustchain:action_result',
      requestId,
      success: true,
      data: result
    }, '*');
  } catch (err) {
    agentFrame.contentWindow.postMessage({
      type: 'trustchain:action_result',
      requestId,
      success: false,
      error: err.message
    }, '*');
  }
});
```

### ะจะฐะณ 3. ะะฑะฝะพะฒะปัะนัะต ะฟัะธ ัะผะตะฝะต ะบะพะฝัะตะบััะฐ

```javascript
// ะัะธ ะฟะตัะตัะพะดะต ะฝะฐ ะดััะณัั ัััะฐะฝะธัั โ ะพัะธัะฐะนัะต ะธ ะฟะตัะตัะตะณะธัััะธััะนัะต
agentFrame.contentWindow.postMessage({ type: 'trustchain:clear_actions' }, '*');
agentFrame.contentWindow.postMessage({
  type: 'trustchain:register_actions',
  actions: getActionsForPage(currentPage)
}, '*');
```

---

## Agent Config โ ะกะฟะตัะธะฐะปะธะทะฐัะธั ะพัะบะตัััะฐัะพัะฐ

ะะณะตะฝั ัะพะดะตัะถะธั **ัะฝะธะฒะตััะฐะปัะฝัะน ะพัะบะตัััะฐัะพั**, ะบะพัะพััะน ะดะตะบะพะผะฟะพะทะธััะตั ัะปะพะถะฝัะต ะทะฐะดะฐัะธ ะฝะฐ ะฟะพะดะทะฐะดะฐัะธ. ะะพ ัะผะพะปัะฐะฝะธั ะพะฝ ะทะฝะฐะตั ัะพะปัะบะพ ัะฝะธะฒะตััะฐะปัะฝัะต ัะฟะตัะธะฐะปะธะทะฐัะธะธ (ะบะพะด, ะฐะฝะฐะปะธะท, ะดะฐะฝะฝัะต). ะฅะพัั-ะฟัะธะปะพะถะตะฝะธะต ะผะพะถะตั ะดะพะฑะฐะฒะธัั **ัะฒะพะธ ะดะพะผะตะฝะฝัะต ัะฟะตัะธะฐะปะธะทะฐัะธะธ**:

```javascript
agentFrame.contentWindow.postMessage({
  type: 'trustchain:agent_config',
  specialties: [
    {
      name: 'document-specialist',
      patterns: ['ะดะพะบัะผะตะฝั', 'ะฒัะพะดัั', 'ะธััะพะดัั', 'ะฟะธััะผะพ', 'document', 'correspondence']
    },
    {
      name: 'task-specialist',
      patterns: ['ะทะฐะดะฐั', 'ะฟะพัััะตะฝ', 'ะดะตะดะปะฐะนะฝ', 'ะธัะฟะพะปะฝะธัะตะป', 'task', 'assignee']
    },
    {
      name: 'hr-specialist',
      patterns: ['ะบะฐะดั', 'ัะพัััะดะฝะธะบ', 'ะฒะฐะบะฐะฝัะธั', 'hr', 'employee']
    }
  ],
  complexityKeywords: ['ะดะพะบัะผะตะฝัะพะพะฑะพัะพั', 'contract management', 'workflow']
}, '*');
```

ะญัะพ ะทะฐััะฐะฒะปัะตั ะพัะบะตัััะฐัะพั ะฟัะฐะฒะธะปัะฝะพ ัะฐัะฟัะตะดะตะปััั ะฟะพะดะทะฐะดะฐัะธ ะฒ ัะปะพะถะฝัั ะทะฐะฟัะพัะฐั ัะธะฟะฐ: *ยซะะพะบะฐะถะธ ะฒัะต ะฟัะพััะพัะตะฝะฝัะต ะทะฐะดะฐัะธ ะธ ะฒัะพะดััะธะต ะดะพะบัะผะตะฝัั ะทะฐ ัะฝะฒะฐัั, ะฐ ัะฐะบะถะต ััะฐัะธััะธะบั ะฟะพ HRยป* โ 3 ะฟะพะดะทะฐะดะฐัะธ ะฟะพ ัะฟะตัะธะฐะปะธััะฐะผ.

---

## Skills โ ะะพะฝัะตะบััะฝัะต ะบะฝะพะฟะบะธ

### ะัะธะผะตั: ะบะพะฝัะตะบััะฝัะต ะฝะฐะฒัะบะธ ะฟัะธ ะฒัะฑะพัะต ัะปะตะผะตะฝัะฐ

```javascript
panelFrame.contentWindow.postMessage({
  type: 'trustchain:skills',
  skills: [
    { label: 'ะะฝะฐะปะธะท', prompt: 'ะัะพะฐะฝะฐะปะธะทะธััะน ะฒัะฑัะฐะฝะฝัะน ัะปะตะผะตะฝั', color: '#a78bfa' },
    { label: 'ะกัะฐะฒะฝะธัั', prompt: 'ะะฐะนะดะธ ะฐะฝะฐะปะพะณะธ ะธ ััะฐะฒะฝะธ', color: '#06b6d4' },
    { label: 'ะัััั', prompt: 'ะกะพะทะดะฐะน ะพัััั', color: '#34d399' },
  ]
}, '*');
```

---

## Intent Patterns โ ะะฐััะพะผะฝะฐั ะผะฐัััััะธะทะฐัะธั ะทะฐะฟัะพัะพะฒ

ะะณะตะฝั ัะพะดะตัะถะธั **ัะฝะธะฒะตััะฐะปัะฝัะน intent classifier** (`TaskIntentService`), ะบะพัะพััะน
ัะฐะทะฑะธะฒะฐะตั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะฐ ัะฐะณะธ ั ะฝะตะพะฑัะพะดะธะผัะผะธ ะธะฝััััะผะตะฝัะฐะผะธ.
ะัะพะตะบั ะผะพะถะตั ะพะฑะพะณะฐัะธัั ะตะณะพ ะดะพะผะตะฝะฝัะผะธ ะฟะฐััะตัะฝะฐะผะธ ัะตัะตะท `trustchain:intent_patterns`:

```javascript
panelFrame.contentWindow.postMessage({
  type: 'trustchain:intent_patterns',
  patterns: [
    {
      action: 'search',
      patterns: ['ะดะพะบัะผะตะฝั.*ะทะฐ\\s+(ัะฝะฒะฐัั|ัะตะฒัะฐะปั)', 'ะฒัะพะดัั.*ะฟะธััะผ'],
      requiredTools: ['mcp_panel_app_list_documents']
    },
    {
      action: 'analyze',
      patterns: ['ััะฐัะธััะธะบ.*ะดะพะบัะผะตะฝั', 'ัะบะพะปัะบะพ.*ะทะฐะดะฐั'],
      requiredTools: ['mcp_panel_app_get_dashboard_stats']
    }
  ]
}, '*');

panelFrame.contentWindow.postMessage({
  type: 'trustchain:domain_hints',
  hints: 'ะกะธััะตะผะฐ ะดะพะบัะผะตะฝัะพะพะฑะพัะพัะฐ. ะะฐะฑะพัะฐ ั ะดะพะบัะผะตะฝัะฐะผะธ, ะทะฐะดะฐัะฐะผะธ, ัะพะฒะตัะฐะฝะธัะผะธ, ะดะพะณะพะฒะพัะฐะผะธ.'
}, '*');
```

---

## Built-in Universal Tools

ะะณะตะฝั ัะพะดะตัะถะธั ะฝะฐะฑะพั **ัะฝะธะฒะตััะฐะปัะฝัั ะธะฝััััะผะตะฝัะพะฒ** ะธะท ะบะพัะพะฑะบะธ. ะะฝะธ ะดะพัััะฟะฝั ะะกะะ ะฟัะธะปะพะถะตะฝะธัะผ ะฑะตะท ะฝะฐัััะพะนะบะธ.

| ะะฐัะตะณะพัะธั | Tools | ะะฟะธัะฐะฝะธะต |
|-----------|-------|----------|
| **Web** | `web_search`, `web_fetch` | ะะพะธัะบ ะธ ะทะฐะณััะทะบะฐ ะฒะตะฑ-ัััะฐะฝะธั |
| **Page** | `page_observe`, `page_read`, `page_interact` | ะะทะฐะธะผะพะดะตะนััะฒะธะต ัะพ ัััะฐะฝะธัะตะน ัะตัะตะท Playwright |
| **Code** | `execute_code`, `run_terminal` | ะัะฟะพะปะฝะตะฝะธะต ะบะพะดะฐ ะฒ Docker sandbox |
| **Data** | `analyze_data`, `transform` | ะะฑัะฐะฑะพัะบะฐ CSV/JSON/Excel |
| **Browser** | `screenshot`, `click`, `type` | ะฃะฟัะฐะฒะปะตะฝะธะต Playwright-ะฑัะฐัะทะตัะพะผ |
| **Artifacts** | `create_artifact` | ะกะพะทะดะฐะฝะธะต ะฒัััะฐะธะฒะฐะตะผัั ะฐััะตัะฐะบัะพะฒ |

> [!TIP]
> ะะต ะดัะฑะปะธััะนัะต ััะธ ะธะฝััััะผะตะฝัั ะฒ ะฒะฐัะตะผ MCP Server. ะัะปะธ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพะฟัะพัะธั "ะฟะพะธัะบะฐัั ะฒ ะธะฝัะตัะฝะตัะต" ะธะปะธ "ะฒัะฟะพะปะฝะธัั ะบะพะด" โ ะฐะณะตะฝั ัะฟัะฐะฒะธััั ัะฐะผ.

---

## 4-Tier Architecture โ ะัะบัะดะฐ ะฐะณะตะฝั ะฑะตััั ะธะฝััััะผะตะฝัั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  LLM ะฒัะฑะธัะฐะตั tool ะธะท ะฟะพะปะฝะพะณะพ ัะฟะธัะบะฐ ะฒัะตั 4 ััะพะฒะฝะตะน     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  Tier 1: Built-in        โ web, code, data, artifacts  โ
โ  Tier 2: MCP Server      โ ะฒะฐัะธ CRUD, ะฟะพะธัะบ, ัะบัะฟะพัั   โ
โ  Tier 3: Page Tools      โ page_observe, page_read, ... โ
โ  Tier 4: App Actions     โ register_actions postMessage โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**Tier 1โ3** ัะฐะฑะพัะฐัั ะธะท ะบะพัะพะฑะบะธ. **Tier 4** ะฝะฐัััะฐะธะฒะฐะตััั ะฒะฐัะธะผ ะฟัะธะปะพะถะตะฝะธะตะผ.

---

## ะงะตะบ-ะปะธัั ะธะฝัะตะณัะฐัะธะธ

### ๐ข ะฃัะพะฒะตะฝั 1 โ ะะธะฝะธะผะฐะปัะฝะฐั ะธะฝัะตะณัะฐัะธั (1โ2 ัะฐัะฐ)

ะะพััะฐัะพัะฝะพ ะดะปั ัะฐะฑะพัะฐััะตะณะพ ะฟัะพัะพัะธะฟะฐ.

- [ ] MCP Server ะทะฐะฟััะตะฝ ะธ ะพัะฒะตัะฐะตั ะฝะฐ `GET /health`
- [ ] `POST /tools/list` ะฒะพะทะฒัะฐัะฐะตั ะผะฐััะธะฒ tools ั `name`, `description`, `inputSchema`
- [ ] ะะฐะถะดัะน `description` ัะพะดะตัะถะธั: **ััะพ ะดะตะปะฐะตั**, **ััะพ ะฒะพะทะฒัะฐัะฐะตั**, **ะบะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั**
- [ ] `POST /tools/call` ะฒะพะทะฒัะฐัะฐะตั `result.content` (ะดะฐะถะต ะฟัะธ ะพัะธะฑะบะฐั โ ัะตะบััะพะผ, ะฝะต HTTP 500)
- [ ] `describe_platform` tool ัะตะฐะปะธะทะพะฒะฐะฝ โ ะฐะณะตะฝั ะทะฝะฐะตั ััะพ ะทะฐ ะฟะปะฐััะพัะผะฐ
- [ ] `describe_current_page` tool ัะตะฐะปะธะทะพะฒะฐะฝ โ ะฐะณะตะฝั ะทะฝะฐะตั ัะตะบััะธะน ะบะพะฝัะตะบัั
- [ ] `<iframe>` ั ะฟะฐะฝะตะปัั ะพัะพะฑัะฐะถะฐะตััั ะฝะฐ ัะพัั-ัััะฐะฝะธัะต
- [ ] ะ ะบะพะฝัะพะปะธ ะฒะธะดะฝะพ: `[MCP] Connected to ...` + ัะฟะธัะพะบ tools
- [ ] System prompt ะฟะตัะตะดะฐัััั ัะตัะตะท `?system=` ะฟะฐัะฐะผะตัั

### ๐ก ะฃัะพะฒะตะฝั 2 โ ะะพะปะฝะฐั ะธะฝัะตะณัะฐัะธั (4โ8 ัะฐัะพะฒ)

ะะณะตะฝั ะฟะพะปะฝะพัะตะฝะฝะพ ะธะฝัะตะณัะธัะพะฒะฐะฝ ะฒ ะฒะฐัะต ะฟัะธะปะพะถะตะฝะธะต.

- [ ] Skills (`trustchain:skills`) ะพะฑะฝะพะฒะปััััั ะฟัะธ ัะผะตะฝะต ะบะพะฝัะตะบััะฐ ัััะฐะฝะธัั
- [ ] App Actions ะทะฐัะตะณะธัััะธัะพะฒะฐะฝั ะดะปั client-side UI-ะพะฟะตัะฐัะธะน
- [ ] `trustchain:call_action` ะพะฑัะฐะฑะฐััะฒะฐะตััั ัะพัั-ัััะฐะฝะธัะตะน
- [ ] Actions ะพัะธัะฐัััั ะธ ะฟะตัะตัะตะณะธัััะธัััััั ะฟัะธ ะฝะฐะฒะธะณะฐัะธะธ
- [ ] Intent patterns ะฝะฐัััะพะตะฝั ะดะปั ัะพัะฝะพะน ะผะฐัััััะธะทะฐัะธะธ ะทะฐะฟัะพัะพะฒ
- [ ] Domain hints ะฟะตัะตะดะฐะฝั ะดะปั ัะพัะฝะพะน ะบะปะฐััะธัะธะบะฐัะธะธ ะทะฐะฟัะพัะพะฒ LLM
- [ ] ะกะฟะธัะบะพะฒัะต tools ะฟะพะดะดะตัะถะธะฒะฐัั ะฟะฐะณะธะฝะฐัะธั (limit/offset)
- [ ] TrustChain `trustchain` ะพะฑัะตะบั ะปะพะณะธััะตััั ะฟัะธ ะบะฐะถะดะพะผ `tools/call`

### ๐ด ะฃัะพะฒะตะฝั 3 โ ะัะพะดะฒะธะฝััะฐั ะธะฝัะตะณัะฐัะธั

ะะฐะบัะธะผะฐะปัะฝะฐั ะบะฐััะพะผะธะทะฐัะธั ะธ ะฑะตะทะพะฟะฐัะฝะพััั.

- [ ] Agent Config โ ัะฟะตัะธะฐะปะธะทะฐัะธั ะพัะบะตัััะฐัะพัะฐ (`trustchain:agent_config`)
- [ ] TrustChain ะฟะพะดะฟะธัะธ ะฒะตัะธัะธัะธัััััั (Ed25519) ะฝะฐ ััะพัะพะฝะต MCP Server
- [ ] Audit trail ัะพััะฐะฝัะตััั ะฒ ะพัะดะตะปัะฝัั ัะฐะฑะปะธัั
- [ ] Playwright MCP ะทะฐะฟััะตะฝ ะดะปั ะฒะธะทัะฐะปัะฝะพะณะพ ะดะพัััะฟะฐ ะบ ัััะฐะฝะธัะต
- [ ] ะกะพะฑััะฒะตะฝะฝัะน greeting ะธ branding ัะตัะตะท `trustchain:agent_config`

---

## Anti-patterns โ ะงะตะณะพ ะะ ะดะตะปะฐัั

| โ ะะต ะดะตะปะฐะนัะต | โ ะะตะปะฐะนัะต ะฒะผะตััะพ ััะพะณะพ |
|--------------|------------------------|
| ะฅะฐัะดะบะพะด tools ะฒ ะบะพะดะต ะฐะณะตะฝัะฐ | ะญะบัะฟะพััะธััะนัะต ัะตัะตะท MCP Server |
| ะัะฑะปะธัะพะฒะฐะฝะธะต built-in tools (web_search ะธ ั.ะด.) | ะะณะตะฝั ัะถะต ัะผะตะตั โ ะฝะต ะดัะฑะปะธััะนัะต |
| HTTP 500 ะฟัะธ ะพัะธะฑะบะต tool | ะะตัะฝะธัะต ัะตะบัั ะพัะธะฑะบะธ ะฒ `result.content` |
| ะะฟะธัะฐะฝะธั ัะธะฟะฐ "ะะพะปััะธัั ะดะฐะฝะฝัะต" | ะะพะดัะพะฑะฝัะต ะพะฟะธัะฐะฝะธั: ััะพ, ะบะพะณะดะฐ, ัะพัะผะฐั ะฒะพะทะฒัะฐัะฐ |
| ะะดะธะฝ ะพะณัะพะผะฝัะน tool ะฝะฐ ะฒัั | ะะฐะทะฑะตะนัะต ะฝะฐ ะฐัะพะผะฐัะฝัะต CRUD ะพะฟะตัะฐัะธะธ |
| System prompt ะฒะฝัััะธ ะบะพะดะฐ ะฐะณะตะฝัะฐ | ะะตัะตะดะฐะฒะฐะนัะต ัะตัะตะท `?system=` URL ะฟะฐัะฐะผะตัั |

---

## Troubleshooting

| ะกะธะผะฟัะพะผ | ะะตัะตะฝะธะต |
|---------|---------|
| ะะณะตะฝั ะฝะต ะฒะธะดะธั tools | `curl -X POST http://localhost:7323/tools/list` โ ะฟัะพะฒะตัััะต ะพัะฒะตั |
| CORS ะพัะธะฑะบะฐ | ะะพะฑะฐะฒััะต CORS headers ะธะปะธ ะธัะฟะพะปัะทัะนัะต Vite proxy |
| Tools ะฒะธะดะฝั, ะฝะพ ะฝะต ะฒัะทัะฒะฐัััั | ะัะพะฒะตัััะต ะปะพะณะธ MCP Server, ัะพัะผะฐั `result.content` |
| ะะณะตะฝั ะฟััะฐะตััั ะฒ tools | ะฃะปัััะธัะต `description` โ ะฟะพะดัะพะฑะฝะตะต, ะบะพะฝะบัะตัะฝะตะต |
| ะกะปะธัะบะพะผ ะผะฝะพะณะพ ะดะฐะฝะฝัั | ะะพะฑะฐะฒััะต `limit` ะฟะฐัะฐะผะตัั, ัะพะบัะฐัะธัะต ะพัะฒะตั ะดะพ <50 ะะ |
| ะะฐะฝะตะปั ะฝะต ะทะฐะณััะถะฐะตััั | `cd TrustChain_Agent && npm run dev` |
| App Action ะฝะต ะฒัะทัะฒะฐะตััั | ะัะพะฒะตัััะต ััะพ `trustchain:register_actions` ะพัะฟัะฐะฒะปะตะฝ **ะฟะพัะปะต** ะทะฐะณััะทะบะธ iframe |
| ะะณะตะฝั ะฝะต ะฒะธะดะธั App Actions | ะัะพะฒะตัััะต ะฒ ะบะพะฝัะพะปะธ: `[AppActionsRegistry] Registered N actions` |
| ะัะบะตัััะฐัะพั ะฝะต ะธัะฟะพะปัะทัะตั ะฒะฐัะธ ัะฟะตัะธะฐะปะธะทะฐัะธะธ | ะัะฟัะฐะฒะธะปะธ `trustchain:agent_config` **ะดะพ** ะพัะฟัะฐะฒะบะธ ะทะฐะฟัะพัะฐ? |

---

**TrustChain Agent Integration Standard v3.0** โข [Model Context Protocol](https://modelcontextprotocol.io/) โข Ed25519 Cryptographic Verification
